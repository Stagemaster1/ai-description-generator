<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://www.gstatic.com https://apis.google.com; style-src 'self' https://fonts.googleapis.com; img-src 'self' data: https:; connect-src 'self' https://api.openai.com https://world.openfoodfacts.org https://api.upcdatabase.org https://api.barcodelookup.com https://identitytoolkit.googleapis.com https://securetoken.googleapis.com; font-src 'self' https://fonts.gstatic.com;">
    <title>SolTecSol - AI Product Description Generator</title>
    
    <!-- Firebase SDK and Security Modules -->

    <!-- Cross-Domain Authentication Client -->
    <script src="./cross-domain-auth-client.js"></script>

    <!-- External Security and Token Management Scripts -->
    <script src="./js/token-manager.js"></script>
    <script src="./js/secure-cookies.js"></script>
    <script type="module" src="./js/firebase-init.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #6b7280;
            min-height: 100vh;
            color: #ffffff;
            overflow-x: hidden;
        }
        
        .container {
            background: linear-gradient(135deg, #0a0f1c 0%, #1a1f2e 25%, #2d1b69 50%, #1e3a8a 75%, #0f172a 100%);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .floating-element {
            position: absolute;
            opacity: 0.1;
            animation: float 20s infinite ease-in-out;
        }

        .floating-element:nth-child(1) {
            top: 20%;
            left: 10%;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            border-radius: 50%;
            animation-delay: 0s;
        }

        .floating-element:nth-child(2) {
            top: 60%;
            right: 15%;
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #10b981, #3b82f6);
            border-radius: 30%;
            animation-delay: 7s;
        }

        .floating-element:nth-child(3) {
            bottom: 30%;
            left: 20%;
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #f59e0b, #ef4444);
            border-radius: 50%;
            animation-delay: 14s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-30px) rotate(120deg); }
            66% { transform: translateY(15px) rotate(240deg); }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header {
            text-align: center;
            padding: 60px 0;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #3b82f6, transparent);
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 800;
            color: #111827;
            margin-bottom: 20px;
            letter-spacing: -1px;
        }

        .company-name {
            font-size: 1.3rem;
            color: #1f2937;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .tagline {
            font-size: 1.3rem;
            color: #111827;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .subtitle {
            font-size: 1rem;
            color: #374151;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 60px;
            align-items: stretch;
        }

        .generator-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .generator-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #ffffff, #cbd5e1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .usage-tracker {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .usage-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .usage-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #e2e8f0;
            font-size: 0.95rem;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: #ffffff;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        /* Improved form select styling for better readability */
        .form-select {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .form-select option {
            background: #1e293b;
            color: #ffffff;
            padding: 10px;
            border: none;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #3b82f6;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }

        .form-input::placeholder {
            color: #94a3b8;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            margin: auto;
            border: 2px solid transparent;
            border-top-color: #ffffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
        }

        @keyframes spin {
            0% { transform: translateY(-50%) rotate(0deg); }
            100% { transform: translateY(-50%) rotate(360deg); }
        }

        .results {
            margin-top: 30px;
            padding: 25px;
            background: rgba(16, 185, 129, 0.1);
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }

        .results h3 {
            color: #10b981;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .results-content {
            color: #e2e8f0;
            line-height: 1.7;
            white-space: pre-wrap;
        }


        .stats-section {
            text-align: center;
            padding: 60px 0;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 24px;
            margin: 60px 0;
            backdrop-filter: blur(10px);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            margin-top: 40px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #60a5fa, #a78bfa, #fb7185);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: block;
        }

        .stat-label {
            color: #94a3b8;
            font-size: 1rem;
            margin-top: 8px;
        }

        /* Language Selector Styles */
        .language-option:hover {
            background: rgba(255,255,255,0.1) !important;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 30px;
            }


            .header {
                padding: 40px 0;
            }

            .logo {
                font-size: 2rem;
            }

            .tagline {
                font-size: 1.1rem;
            }

            .generator-section {
                padding: 30px 20px;
            }

            .section-title {
                font-size: 1.5rem;
            }
        }

        .error {
            color: #ef4444;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .form-input.error, .form-select.error, .form-textarea.error {
            border-color: #ef4444;
        }

        .success-animation {
            animation: successPulse 0.6s ease-out;
        }

        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .input-method-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .method-btn {
            flex: 1;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: #94a3b8;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .method-btn.active {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
            color: #60a5fa;
        }

        .method-btn:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .input-group {
            display: none;
        }

        .input-group.active {
            display: block;
        }

        .barcode-lookup-btn {
            width: 100%;
            margin-top: 10px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .barcode-lookup-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .barcode-lookup-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .product-preview {
            margin-top: 15px;
            padding: 20px;
            background: rgba(16, 185, 129, 0.1);
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .preview-content {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .preview-image {
            flex-shrink: 0;
            width: 60px;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .preview-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .preview-details h4 {
            color: #10b981;
            margin-bottom: 5px;
            font-size: 1rem;
        }

        .preview-details p {
            color: #cbd5e1;
            font-size: 0.9rem;
            margin-bottom: 3px;
        }



        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, #10b981, #059669);
        }

       .notification.error {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }


    </style>
</head>
<body>
    <div class="bg-animation">
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
    </div>

    <header class="header">
        <div style="position: absolute; top: 20px; right: 20px;">
            <div class="language-selector" style="position: relative;">
                <button id="languageToggle" onclick="toggleLanguageDropdown()" style="
                    background: rgba(0,0,0,0.8);
                    border: 1px solid rgba(255,255,255,0.3);
                    border-radius: 8px;
                    color: #ffffff;
                    padding: 8px 12px;
                    font-size: 0.9rem;
                    cursor: pointer;
                    backdrop-filter: blur(10px);
                    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                    display: flex;
                    align-items: center;
                    gap: 8px;
                ">
                    <span id="currentLanguageFlag">🇺🇸</span>
                    <span id="currentLanguageName">English</span>
                    <span style="font-size: 0.7rem;">▼</span>
                </button>
                
                <div id="languageDropdown" style="
                    position: absolute;
                    top: 100%;
                    right: 0;
                    background: rgba(0,0,0,0.9);
                    border: 1px solid rgba(255,255,255,0.3);
                    border-radius: 8px;
                    backdrop-filter: blur(15px);
                    box-shadow: 0 8px 25px rgba(0,0,0,0.4);
                    min-width: 180px;
                    z-index: 9999;
                    display: none;
                    margin-top: 5px;
                ">
                    <div class="language-option" onclick="selectLanguage('en')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇺🇸</span> English
                    </div>
                    <div class="language-option" onclick="selectLanguage('es')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇪🇸</span> Español
                    </div>
                    <div class="language-option" onclick="selectLanguage('fr')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇫🇷</span> Français
                    </div>
                    <div class="language-option" onclick="selectLanguage('de')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇩🇪</span> Deutsch
                    </div>
                    <div class="language-option" onclick="selectLanguage('it')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇮🇹</span> Italiano
                    </div>
                    <div class="language-option" onclick="selectLanguage('pt')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇵🇹</span> Português
                    </div>
                    <div class="language-option" onclick="selectLanguage('nl')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇳🇱</span> Nederlands
                    </div>
                    <div class="language-option" onclick="selectLanguage('ja')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇯🇵</span> 日本語
                    </div>
                    <div class="language-option" onclick="selectLanguage('zh')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇨🇳</span> 中文
                    </div>
                    <div class="language-option" onclick="selectLanguage('ru')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇷🇺</span> Русский
                    </div>
                    <div class="language-option" onclick="selectLanguage('ar')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇸🇦</span> العربية
                    </div>
                    <div class="language-option" onclick="selectLanguage('hi')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇮🇳</span> हिन्दी
                    </div>
                    <div class="language-option" onclick="selectLanguage('ko')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇰🇷</span> 한국어
                    </div>
                </div>
            </div>
        </div>
        
        <div class="company-name">SolTecSol - Solid Tech Solutions</div>

        <!-- Navigation Links -->
        <div style="position: absolute; top: 70px; left: 20px; z-index: 1000; display: flex; gap: 12px;">
            <a href="https://subscriptions.soltecsol.com" target="_blank" rel="noopener noreferrer" style="
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                border: none;
                border-radius: 8px;
                color: #ffffff;
                padding: 10px 20px;
                font-size: 0.9rem;
                font-weight: 600;
                cursor: pointer;
                text-decoration: none;
                display: inline-flex;
                align-items: center;
                gap: 8px;
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
                backdrop-filter: blur(10px);
                transition: all 0.3s ease;
            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.4)'"
               onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)'">
                <span>💳</span>
                <span data-translate="subscriptionPlans">Subscription Plans</span>
            </a>

            <a href="javascript:void(0)" onclick="openSignupWithReturn()" target="_blank" rel="noopener noreferrer" style="
                background: linear-gradient(135deg, #10b981 0%, #059669 100%);
                border: none;
                border-radius: 8px;
                color: #ffffff;
                padding: 10px 20px;
                font-size: 0.9rem;
                font-weight: 600;
                cursor: pointer;
                text-decoration: none;
                display: inline-flex;
                align-items: center;
                gap: 8px;
                box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
                backdrop-filter: blur(10px);
                transition: all 0.3s ease;
            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(16, 185, 129, 0.4)'"
               onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(16, 185, 129, 0.3)'">
                <span>👤</span>
                <span data-translate="createAccount">Create Account</span>
            </a>

            <a href="javascript:void(0)" onclick="openSigninWithReturn()" style="
                background: rgba(255, 255, 255, 0.1);
                border: 2px solid rgba(255, 255, 255, 0.2);
                border-radius: 8px;
                color: #ffffff;
                padding: 8px 18px;
                font-size: 0.9rem;
                font-weight: 600;
                cursor: pointer;
                text-decoration: none;
                display: inline-flex;
                align-items: center;
                gap: 8px;
                backdrop-filter: blur(10px);
                transition: all 0.3s ease;
            " onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.borderColor='rgba(255, 255, 255, 0.3)'"
               onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.borderColor='rgba(255, 255, 255, 0.2)'">
                <span>🔐</span>
                <span data-translate="signIn">Sign In</span>
            </a>
        </div>

        <h1 class="logo" data-translate="appTitle">AI Description Generator</h1>
        <p class="tagline" data-translate="tagline">Transform Product URLs into Converting Copy</p>
        <p class="subtitle" data-translate="subtitle">Generate SEO-optimized, brand-specific product descriptions that convert browsers into buyers. Save hours of writing time and boost your e-commerce sales.</p>
    </header>

    <div class="container">

        <div class="main-content">
            <div class="generator-section">
                <h2 class="section-title" data-translate="generateSection">🚀 Generate Your Description</h2>
                
                <div class="usage-tracker" id="usageTracker">
                    <div style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 5px; display: flex; align-items: center; justify-content: space-between;">
                        <span data-translate="monthlyUsage">Monthly Usage</span>
                        <button onclick="refreshUsage()" style="background: none; border: none; color: #94a3b8; cursor: pointer; padding: 2px; font-size: 0.8rem;" title="Refresh usage data">🔄</button>
                    </div>
                    <div style="color: #ffffff; font-weight: 600;" id="usageText">0 of 3 free descriptions used</div>
                    <div class="usage-bar">
                        <div class="usage-fill" id="usageFill" style="width: 0%;"></div>
                    </div>
                    <div style="color: #94a3b8; font-size: 0.8rem; margin-top: 5px;">
                        <a href="https://subscriptions.soltecsol.com" target="_blank" id="upgradePrompt" style="
                            color: #667eea;
                            text-decoration: none;
                            cursor: pointer;
                            transition: color 0.3s ease;
                        " onmouseover="this.style.color='#764ba2'"
                           onmouseout="this.style.color='#667eea'">Upgrade for unlimited descriptions →</a>
                    </div>
                </div>
                
                <form id="descriptionForm">
                    <div class="form-group">
                        <label class="form-label" data-translate="productIdentification">Product Identification</label>
                        <div class="input-method-selector">
                            <button type="button" id="urlModeBtn" class="method-btn active" data-translate="productURL">🔗 Product URL</button>
                            <button type="button" id="barcodeModeBtn" class="method-btn" data-translate="barcodeUPC">📊 Barcode/UPC</button>
                            <button type="button" id="manualModeBtn" class="method-btn" data-translate="manualEntry">✏️ Manual Entry</button>
                        </div>
                        
                        <div id="urlInputGroup" class="input-group active">
                            <input 
                                type="url" 
                                id="productUrl" 
                                class="form-input" 
                                placeholder="https://www.aliexpress.com/item/..." 
                                data-translate-placeholder="productUrlPlaceholder"
                            >
                            <div class="error" id="urlError"></div>
                        </div>
                        
                        <div id="barcodeInputGroup" class="input-group">
                            <input 
                                type="text" 
                                id="productBarcode" 
                                class="form-input" 
                                placeholder="Enter barcode/UPC (e.g., 123456789012)" 
                                data-translate-placeholder="barcodePlaceholder"
                                pattern="[0-9]{8,13}"
                                title="Enter 8-13 digit barcode or UPC"
                            >
                            <button type="button" id="lookupBarcodeBtn" class="barcode-lookup-btn" data-translate="lookupProduct">🔍 Lookup Product</button>
                            <div class="error" id="barcodeError"></div>
                        </div>
                        
                        <div id="manualInputGroup" class="input-group">
                            <input 
                                type="text" 
                                id="productName" 
                                class="form-input" 
                                placeholder="Enter product name (e.g., 'Wireless Bluetooth Headphones')"
                                data-translate-placeholder="productNamePlaceholder"
                            >
                            <div class="error" id="manualError"></div>
                        </div>
                        
                        <div id="productPreview" class="product-preview" style="display: none;">
                            <div class="preview-content">
                                <div class="preview-image">
                                    <img id="previewImage" src="" alt="Product" />
                                </div>
                                <div class="preview-details">
                                    <h4 id="previewName">Product Name</h4>
                                    <p id="previewBrand">Brand</p>
                                    <p id="previewCategory">Category</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="brandTone" class="form-label" data-translate="brandTone">Brand Tone</label>
                        <select id="brandTone" class="form-select" required>
                            <option value="" data-translate="selectBrandVoice">Select your brand voice...</option>
                            <option value="luxury" data-translate="luxuryPremium">Luxury & Premium</option>
                            <option value="casual" data-translate="casualFriendly">Casual & Friendly</option>
                            <option value="professional" data-translate="professionalAuthoritative">Professional & Authoritative</option>
                            <option value="fun" data-translate="funQuirky">Fun & Quirky</option>
                            <option value="minimalist" data-translate="minimalistClean">Minimalist & Clean</option>
                        </select>
                        <div class="error" id="brandToneError"></div>
                    </div>

                    <div class="form-group">
                        <label for="descriptionLength" class="form-label" data-translate="descriptionLength">Description Length</label>
                        <select id="descriptionLength" class="form-select" required>
                            <option value="short" data-translate="shortLength">Short (50-100 words) - Quick & Punchy</option>
                            <option value="medium" data-translate="mediumLength">Medium (150-250 words) - Recommended</option>
                            <option value="extensive" data-translate="extensiveLength">Extensive (300-500 words) - Detailed</option>
                        </select>
                        <div class="error" id="descriptionLengthError"></div>
                    </div>

                    <div class="form-group">
                        <label for="language" class="form-label" data-translate="language">Language</label>
                        <select id="language" class="form-select" required>
                            <option value="english">🇺🇸 English</option>
                            <option value="german">🇩🇪 German (Deutsch)</option>
                            <option value="spanish">🇪🇸 Spanish (Español)</option>
                            <option value="french">🇫🇷 French (Français)</option>
                            <option value="japanese">🇯🇵 Japanese (日本語)</option>
                            <option value="italian">🇮🇹 Italian (Italiano)</option>
                            <option value="dutch">🇳🇱 Dutch (Nederlands)</option>
                            <option value="portuguese">🇵🇹 Portuguese (Português)</option>
                            <option value="korean">🇰🇷 Korean (한국어)</option>
                            <option value="russian">🇷🇺 Russian (Русский)</option>
                            <option value="arabic">🇸🇦 Arabic (العربية)</option>
                            <option value="chinese">🇨🇳 Chinese Simplified (中文)</option>
                            <option value="hindi">🇮🇳 Hindi (हिंदी)</option>
                        </select>
                        <div class="error" id="languageError"></div>
                    </div>

                    <div class="form-group">
                        <label for="targetAudience" class="form-label" data-translate="targetAudience">Target Audience (Optional)</label>
                        <input 
                            type="text" 
                            id="targetAudience" 
                            class="form-input" 
                            placeholder="e.g., busy parents, fitness enthusiasts, tech professionals"
                            data-translate-placeholder="targetAudiencePlaceholder"
                        >
                    </div>

                    <div class="form-group">
                        <label for="keyFeatures" class="form-label" data-translate="keyFeatures">Key Features to Highlight (Optional)</label>
                        <textarea 
                            id="keyFeatures" 
                            class="form-textarea" 
                            placeholder="List the most important features you want to emphasize..."
                            data-translate-placeholder="keyFeaturesPlaceholder"
                        ></textarea>
                    </div>

                    <button type="submit" class="btn-primary" id="generateBtn" data-translate="generateDescription">
                        Generate AI Description
                    </button>
                </form>

                <div id="results" class="results" style="display: none;">
                    <h3 data-translate="optimizedDescription">✨ Your Optimized Product Description</h3>
                    <div id="resultsContent" class="results-content"></div>
                    <button type="button" class="btn-primary" id="copyBtn" style="margin-top: 15px;" data-translate="copyToClipboard">
                        📋 Copy to Clipboard
                    </button>
                </div>
            </div>

        </div>

        <div class="stats-section">
            <h2 class="section-title" data-translate="trustedByLeaders">🎯 Trusted by E-commerce Leaders</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-number">10K+</span>
                    <span class="stat-label" data-translate="descriptionsGenerated">Descriptions Generated</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">250%</span>
                    <span class="stat-label" data-translate="averageSalesIncrease">Average Sales Increase</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">45-60min</span>
                    <span class="stat-label" data-translate="averageTimeSaved">Average Time Saved</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">98%</span>
                    <span class="stat-label" data-translate="customerSatisfaction">Customer Satisfaction</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global app state
        let currentLanguage = 'en';
        
        // Translation dictionaries
        const translations = {
            en: {
                // Header
                pageTitle: 'SolTecSol - AI Product Description Generator',
                companyName: 'SolTecSol',
                appTitle: 'AI Description Generator',
                subscriptionPlans: 'Subscription Plans',
                createAccount: 'Create Account',
                signIn: 'Sign In',
                tagline: 'Transform Product URLs into Converting Copy',
                subtitle: 'Generate SEO-optimized, brand-specific product descriptions that convert browsers into buyers. Save hours of writing time and boost your e-commerce sales.',
                
                // Generator Section
                generateSection: '🚀 Generate Your Description',
                monthlyUsage: 'Monthly Usage',
                usedDescriptions: 'descriptions used',
                freeDescriptions: 'free descriptions used',
                of: 'of',
                unlimitedDescriptions: 'unlimited',
                upgradePrompt: 'Upgrade for unlimited descriptions',
                trustedByLeaders: '🎯 Trusted by E-commerce Leaders',
                averageSalesIncrease: 'Average Sales Increase',
                averageTimeSaved: 'Average Time Saved',
                customerSatisfaction: 'Customer Satisfaction',
                
                // Input Mode Buttons
                productURL: '🔗 Product URL',
                barcodeUPC: '📊 Barcode/UPC',
                manualEntry: '✏️ Manual Entry',
                
                // Form Labels
                productIdentification: 'Product Identification',
                productUrl: 'Product URL',
                productUrlPlaceholder: 'https://example.com/product-page',
                barcodeNumber: 'Barcode/UPC Number',
                barcodePlaceholder: 'Enter barcode or UPC number',
                lookupProduct: '🔍 Lookup Product',
                productName: 'Product Name',
                productNamePlaceholder: 'Enter product name',
                brand: 'Brand',
                brandPlaceholder: 'Enter brand name',
                category: 'Category',
                categoryPlaceholder: 'e.g., Electronics, Clothing',
                brandTone: 'Brand Tone',
                descriptionLength: 'Description Length',
                language: 'Language',
                targetAudience: 'Target Audience (Optional)',
                targetAudiencePlaceholder: 'e.g., busy parents, fitness enthusiasts, tech professionals',
                keyFeatures: 'Key Features to Highlight (Optional)',
                keyFeaturesPlaceholder: 'List the most important features you want to emphasize...',
                
                // Brand Tone Options
                selectBrandVoice: 'Select your brand voice...',
                luxuryPremium: 'Luxury & Premium',
                casualFriendly: 'Casual & Friendly',
                professionalAuthoritative: 'Professional & Authoritative',
                funQuirky: 'Fun & Quirky',
                minimalistClean: 'Minimalist & Clean',
                
                // Length Options
                shortLength: 'Short (50-100 words) - Quick & Punchy',
                mediumLength: 'Medium (150-250 words) - Recommended',
                extensiveLength: 'Extensive (300-500 words) - Detailed',
                
                // Buttons
                generateDescription: 'Generate AI Description',
                copyToClipboard: '📋 Copy to Clipboard',
                
                // Results
                optimizedDescription: '✨ Your Optimized Product Description',
                
                
                // Stats
                descriptionsGenerated: 'Descriptions Generated',
                happyCustomers: 'Happy Customers',
                timesSaved: 'Hours Saved',
                
                // Notifications
                descriptionCopied: 'Description copied to clipboard!',
                usageDataRefreshed: 'Usage data refreshed',
                
                // Language Switcher
                selectLanguage: 'Language'
            },
            
            es: {
                // Header
                pageTitle: 'SolTecSol - Generador de Descripciones de Productos con IA',
                companyName: 'SolTecSol (Soluciones Tecnológicas Sólidas)',
                appTitle: 'Generador de Descripciones con IA',
                subscriptionPlans: 'Planes de Suscripción',
                tagline: 'Transforma URLs de Productos en Textos que Convierten',
                subtitle: 'Genera descripciones de productos optimizadas para SEO y específicas de marca que convierten navegadores en compradores. Ahorra horas de tiempo de escritura y aumenta tus ventas de comercio electrónico.',
                
                // Generator Section
                generateSection: '🚀 Genera Tu Descripción',
                monthlyUsage: 'Uso Mensual',
                usedDescriptions: 'descripciones utilizadas',
                freeDescriptions: 'descripciones gratuitas utilizadas',
                of: 'de',
                unlimitedDescriptions: 'ilimitadas',
                upgradePrompt: 'Actualizar para descripciones ilimitadas',
                trustedByLeaders: '🎯 Confianza de Líderes E-commerce',
                averageSalesIncrease: 'Aumento Promedio de Ventas',
                averageTimeSaved: 'Tiempo Promedio Ahorrado',
                customerSatisfaction: 'Satisfacción del Cliente',
                
                // Input Mode Buttons
                productURL: '🔗 URL del Producto',
                barcodeUPC: '📊 Código de Barras/UPC',
                manualEntry: '✏️ Entrada Manual',
                
                // Form Labels
                productIdentification: 'Identificación del Producto',
                productUrl: 'URL del Producto',
                productUrlPlaceholder: 'https://ejemplo.com/pagina-producto',
                barcodeNumber: 'Número de Código de Barras/UPC',
                barcodePlaceholder: 'Introduce código de barras o número UPC',
                lookupProduct: '🔍 Buscar Producto',
                productName: 'Nombre del Producto',
                productNamePlaceholder: 'Introduce nombre del producto',
                brand: 'Marca',
                brandPlaceholder: 'Introduce nombre de la marca',
                category: 'Categoría',
                categoryPlaceholder: 'ej., Electrónicos, Ropa',
                brandTone: 'Tono de Marca',
                descriptionLength: 'Longitud de Descripción',
                language: 'Idioma',
                targetAudience: 'Audiencia Objetivo (Opcional)',
                targetAudiencePlaceholder: 'ej., padres ocupados, entusiastas del fitness, profesionales de tecnología',
                keyFeatures: 'Características Clave a Destacar (Opcional)',
                keyFeaturesPlaceholder: 'Lista las características más importantes que quieres enfatizar...',
                
                // Brand Tone Options
                selectBrandVoice: 'Selecciona la voz de tu marca...',
                luxuryPremium: 'Lujo y Premium',
                casualFriendly: 'Casual y Amigable',
                professionalAuthoritative: 'Profesional y Autoritario',
                funQuirky: 'Divertido y Peculiar',
                minimalistClean: 'Minimalista y Limpio',
                
                // Length Options
                shortLength: 'Corta (50-100 palabras) - Rápida y Directa',
                mediumLength: 'Mediana (150-250 palabras) - Recomendada',
                extensiveLength: 'Extensa (300-500 palabras) - Detallada',
                
                // Buttons
                generateDescription: 'Generar Descripción con IA',
                copyToClipboard: '📋 Copiar al Portapapeles',
                
                // Results
                optimizedDescription: '✨ Tu Descripción de Producto Optimizada',
                
                
                // Stats
                descriptionsGenerated: 'Descripciones Generadas',
                happyCustomers: 'Clientes Satisfechos',
                timesSaved: 'Horas Ahorradas',
                
                // Notifications
                descriptionCopied: '¡Descripción copiada al portapapeles!',
                usageDataRefreshed: 'Datos de uso actualizados',
                
                // Language Switcher
                selectLanguage: 'Idioma'
            },
            
            fr: {
                // Header
                pageTitle: 'SolTecSol - Générateur de Descriptions de Produits IA',
                companyName: 'SolTecSol (Solutions Technologiques Solides)',
                appTitle: 'Générateur de Descriptions IA',
                subscriptionPlans: 'Plans d\'Abonnement',
                tagline: 'Transformez les URLs de Produits en Textes qui Convertissent',
                subtitle: 'Générez des descriptions de produits optimisées SEO et spécifiques à la marque qui convertissent les visiteurs en acheteurs. Économisez des heures de rédaction et augmentez vos ventes e-commerce.',
                
                // Generator Section
                generateSection: '🚀 Générez Votre Description',
                monthlyUsage: 'Usage Mensuel',
                usedDescriptions: 'descriptions utilisées',
                freeDescriptions: 'descriptions gratuites utilisées',
                of: 'de',
                unlimitedDescriptions: 'illimitées',
                upgradePrompt: 'Mettre à niveau pour des descriptions illimitées',
                trustedByLeaders: '🎯 Confiance des Leaders E-commerce',
                averageSalesIncrease: 'Augmentation Moyenne des Ventes',
                averageTimeSaved: 'Temps Moyen Économisé',
                customerSatisfaction: 'Satisfaction Client',
                
                // Input Mode Buttons
                productURL: '🔗 URL du Produit',
                barcodeUPC: '📊 Code-barres/UPC',
                manualEntry: '✏️ Saisie Manuelle',
                
                // Form Labels
                productUrl: 'URL du Produit',
                productUrlPlaceholder: 'https://exemple.com/page-produit',
                barcodeNumber: 'Numéro de Code-barres/UPC',
                barcodePlaceholder: 'Entrez le code-barres ou numéro UPC',
                lookupProduct: '🔍 Rechercher Produit',
                productName: 'Nom du Produit',
                productNamePlaceholder: 'Entrez le nom du produit',
                brand: 'Marque',
                brandPlaceholder: 'Entrez le nom de la marque',
                category: 'Catégorie',
                categoryPlaceholder: 'ex., Électronique, Vêtements',
                brandTone: 'Ton de Marque',
                descriptionLength: 'Longueur de Description',
                language: 'Langue',
                targetAudience: 'Public Cible (Optionnel)',
                targetAudiencePlaceholder: 'ex., Passionnés de tech, Parents, Professionnels',
                keyFeatures: 'Caractéristiques Clés (Optionnel)',
                keyFeaturesPlaceholder: 'ex., Étanche, Garantie 5 ans, Charge rapide',
                
                // Brand Tone Options
                luxuryPremium: 'Luxe et Premium',
                casualFriendly: 'Décontracté et Amical',
                professionalAuthoritative: 'Professionnel et Autoritaire',
                playfulFun: 'Ludique et Amusant',
                minimalistClean: 'Minimaliste et Épuré',
                
                // Length Options
                shortLength: 'Courte (50-100 mots)',
                mediumLength: 'Moyenne (150-250 mots)',
                extensiveLength: 'Longue (300-500 mots)',
                
                // Buttons
                generateDescription: 'Générer Description IA',
                copyDescription: 'Copier Description',
                
                // Results
                optimizedDescription: '✨ Votre Description de Produit Optimisée',
                
                
                
                // Stats
                descriptionsGenerated: 'Descriptions Générées',
                happyCustomers: 'Clients Satisfaits',
                timesSaved: 'Heures Économisées',
                
                // Notifications
                descriptionCopied: 'Description copiée dans le presse-papiers !',
                usageDataRefreshed: 'Données d\'usage actualisées',
                
                // Language Switcher
                selectLanguage: 'Langue'
            },
            
            de: {
                // Header
                pageTitle: 'SolTecSol - KI Produktbeschreibungs-Generator',
                companyName: 'SolTecSol',
                appTitle: 'KI Produktbeschreibungs-Generator',
                subscriptionPlans: 'Abonnementpläne',
                tagline: 'Produkt-URLs in verkaufsfördernde Texte verwandeln',
                subtitle: 'Erstellen Sie SEO-optimierte, markenspezifische Produktbeschreibungen, die Besucher in Käufer verwandeln. Sparen Sie Stunden beim Schreiben und steigern Sie Ihre E-Commerce-Verkäufe.',
                
                // Generator Section
                generateSection: '🚀 Erstellen Sie Ihre Produktbeschreibung',
                monthlyUsage: 'Monatliche Nutzung',
                usedDescriptions: 'verwendete Produktbeschreibungen',
                freeDescriptions: 'kostenlose Produktbeschreibungen verwendet',
                unlimitedDescriptions: 'unbegrenzte Produktbeschreibungen',
                upgradePrompt: 'Upgrade für unbegrenzte Produktbeschreibungen',
                trustedByLeaders: '🎯 Vertrauen von E-Commerce-Führern',
                averageSalesIncrease: 'Durchschnittliche Umsatzsteigerung',
                averageTimeSaved: 'Durchschnittlich gesparte Zeit',
                customerSatisfaction: 'Kundenzufriedenheit',
                
                // Input Mode Buttons
                productURL: '🔗 Produkt-URL',
                barcodeUPC: '📊 Barcode/UPC',
                manualEntry: '✏️ Manuelle Eingabe',
                
                // Form Labels
                productIdentification: 'Produktidentifikation',
                productUrl: 'Produkt-URL',
                productUrlPlaceholder: 'https://beispiel.com/produkt-seite',
                brandTone: 'Markenton',
                descriptionLength: 'Beschreibungslänge',
                targetAudience: 'Zielgruppe (Optional)',
                targetAudiencePlaceholder: 'z.B. beschäftigte Eltern, Fitness-Enthusiasten, Tech-Profis',
                keyFeatures: 'Wichtigste Eigenschaften (Optional)', 
                keyFeaturesPlaceholder: 'Listen Sie die wichtigsten Eigenschaften auf, die Sie betonen möchten...',
                selectBrandVoice: 'Wählen Sie Ihren Markenton...',
                shortLength: 'Kurz (50-100 Wörter) - Knapp & Prägnant',
                language: 'Sprache',
                generateDescription: 'KI-Produktbeschreibung generieren',
                optimizedDescription: '✨ Ihre optimierte Produktbeschreibung',
                
                // Pricing Section
                pricingTitle: '💰 Wählen Sie Ihren Plan',
                pricingSubtitle: 'Schalten Sie unbegrenzte KI-gestützte Beschreibungen frei',
                
                // Plan Names
                starter: 'Starter',
                professional: 'Professionell',
                enterprise: 'Unternehmen',
                mostPopular: 'AM BELIEBTESTEN',
                
                // Plan Features
                firstMonthFree: '🎉 Erster Monat KOSTENLOS',
                perMonth: 'pro Monat',
                perMonthAfterTrial: 'pro Monat nach Testphase',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 Produktbeschreibungen/Monat',
                fiveBrandTones: '5 Marken-Tonarten',
                seoOptimization: 'SEO-Optimierung',
                emailSupport: 'E-Mail-Support',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 Produktbeschreibungen/Monat',
                allBrandTones: 'Alle Marken-Tonarten',
                advancedSeo: 'Erweiterte SEO',
                bulkExport: 'Massenexport',
                prioritySupport: 'Prioritäts-Support',
                
                // Enterprise Plan Features
                unlimitedDescriptionsText: 'Unbegrenzte Produktbeschreibungen',
                customBrandTones: 'Benutzerdefinierte Marken-Tonarten',
                apiAccess: 'API-Zugang',
                teamCollaboration: 'Team-Zusammenarbeit',
                dedicatedSupport: 'Dedizierter Support',
                
                // Language Switcher
                selectLanguage: 'Sprache',
                
                // Brand Tone Options
                luxuryPremium: 'Luxuriös & Premium',
                casualFriendly: 'Lässig & Freundlich',
                professionalAuthoritative: 'Professionell & Kompetent',
                playfulFun: 'Verspielt & Spaßig',
                minimalistClean: 'Minimalistisch & Sauber'
            },
            
            it: {
                // Header
                pageTitle: 'SolTecSol - Generatore di Descrizioni Prodotto AI',
                companyName: 'SolTecSol (Soluzioni Tecnologiche Solide)',
                appTitle: 'Generatore di Descrizioni AI',
                subscriptionPlans: 'Piani di Abbonamento',
                tagline: 'Trasforma gli URL dei Prodotti in Testi che Convertono',
                subtitle: 'Genera descrizioni di prodotti ottimizzate SEO e specifiche del marchio che convertono i visitatori in acquirenti. Risparmia ore di scrittura e aumenta le vendite e-commerce.',
                
                // Generator Section
                generateSection: '🚀 Genera la Tua Descrizione',
                monthlyUsage: 'Uso Mensile',
                usedDescriptions: 'descrizioni utilizzate',
                freeDescriptions: 'descrizioni gratuite utilizzate',
                unlimitedDescriptions: 'illimitate',
                upgradePrompt: 'Aggiorna per descrizioni illimitate',
                trustedByLeaders: '🎯 Fiducia dei Leader E-commerce',
                averageSalesIncrease: 'Aumento Medio delle Vendite',
                averageTimeSaved: 'Tempo Medio Risparmiato',
                customerSatisfaction: 'Soddisfazione del Cliente',
                
                // Form Labels
                productUrl: 'URL del Prodotto',
                productUrlPlaceholder: 'https://esempio.com/pagina-prodotto',
                generateDescription: 'Genera Descrizione AI',
                optimizedDescription: '✨ La Tua Descrizione Prodotto Ottimizzata',
                
                // Pricing Section
                pricingTitle: '💰 Scegli il Tuo Piano',
                pricingSubtitle: 'Sblocca descrizioni AI illimitate',
                
                // Plan Names
                starter: 'Base',
                professional: 'Professionale',
                enterprise: 'Aziendale',
                mostPopular: 'PIÙ POPOLARE',
                
                // Plan Features
                firstMonthFree: '🎉 Primo Mese GRATUITO',
                perMonth: 'al mese',
                perMonthAfterTrial: 'al mese dopo il periodo di prova',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 descrizioni/mese',
                fiveBrandTones: '5 toni di marca',
                seoOptimization: 'Ottimizzazione SEO',
                emailSupport: 'Supporto via email',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 descrizioni/mese',
                allBrandTones: 'Tutti i toni di marca',
                advancedSeo: 'SEO Avanzato',
                bulkExport: 'Esportazione in blocco',
                prioritySupport: 'Supporto prioritario',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'Descrizioni illimitate',
                customBrandTones: 'Toni di marca personalizzati',
                apiAccess: 'Accesso API',
                teamCollaboration: 'Collaborazione di squadra',
                dedicatedSupport: 'Supporto dedicato'
            },
            
            pt: {
                // Header
                pageTitle: 'SolTecSol - Gerador de Descrições de Produtos IA',
                companyName: 'SolTecSol (Soluções Tecnológicas Sólidas)',
                appTitle: 'Gerador de Descrições IA',
                subscriptionPlans: 'Planos de Assinatura',
                tagline: 'Transforme URLs de Produtos em Textos que Convertem',
                subtitle: 'Gere descrições de produtos otimizadas para SEO e específicas da marca que convertem visitantes em compradores. Economize horas de escrita e aumente suas vendas de e-commerce.',
                
                // Generator Section
                generateSection: '🚀 Gere Sua Descrição',
                monthlyUsage: 'Uso Mensal',
                usedDescriptions: 'descrições utilizadas',
                freeDescriptions: 'descrições gratuitas utilizadas',
                unlimitedDescriptions: 'ilimitadas',
                upgradePrompt: 'Atualizar para descrições ilimitadas',
                trustedByLeaders: '🎯 Confiança de Líderes E-commerce',
                averageSalesIncrease: 'Aumento Médio de Vendas',
                averageTimeSaved: 'Tempo Médio Economizado',
                customerSatisfaction: 'Satisfação do Cliente',
                
                // Form Labels
                productUrl: 'URL do Produto',
                productUrlPlaceholder: 'https://exemplo.com/pagina-produto',
                generateDescription: 'Gerar Descrição IA',
                optimizedDescription: '✨ Sua Descrição de Produto Otimizada',
                
                // Pricing Section
                pricingTitle: '💰 Escolha Seu Plano',
                pricingSubtitle: 'Desbloqueie descrições IA ilimitadas',
                
                // Plan Names
                starter: 'Inicial',
                professional: 'Profissional',
                enterprise: 'Empresarial',
                mostPopular: 'MAIS POPULAR',
                
                // Plan Features
                firstMonthFree: '🎉 Primeiro Mês GRÁTIS',
                perMonth: 'por mês',
                perMonthAfterTrial: 'por mês após o período de teste',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 descrições/mês',
                fiveBrandTones: '5 tons de marca',
                seoOptimization: 'Otimização SEO',
                emailSupport: 'Suporte por email',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 descrições/mês',
                allBrandTones: 'Todos os tons de marca',
                advancedSeo: 'SEO Avançado',
                bulkExport: 'Exportação em lote',
                prioritySupport: 'Suporte prioritário',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'Descrições ilimitadas',
                customBrandTones: 'Tons de marca personalizados',
                apiAccess: 'Acesso à API',
                teamCollaboration: 'Colaboração em equipe',
                dedicatedSupport: 'Suporte dedicado'
            },
            
            nl: {
                // Header
                pageTitle: 'SolTecSol - AI Productbeschrijving Generator',
                companyName: 'SolTecSol (Solide Technische Oplossingen)',
                appTitle: 'AI Beschrijving Generator',
                tagline: 'Product URLs omzetten naar Converterende Tekst',
                subtitle: 'Genereer SEO-geoptimaliseerde, merkspecifieke productbeschrijvingen die bezoekers omzetten naar kopers. Bespaar uren schrijftijd en verhoog je e-commerce verkopen.',
                
                // Generator Section
                generateSection: '🚀 Genereer Uw Beschrijving',
                monthlyUsage: 'Maandelijks Gebruik',
                usedDescriptions: 'beschrijvingen gebruikt',
                freeDescriptions: 'gratis beschrijvingen gebruikt',
                of: 'van',
                unlimitedDescriptions: 'onbeperkt',
                upgradePrompt: 'Upgrade voor onbeperkte beschrijvingen',
                trustedByLeaders: '🎯 Vertrouwd door E-commerce Leiders',
                averageSalesIncrease: 'Gemiddelde Verkoop Toename',
                averageTimeSaved: 'Gemiddeld Bespaarde Tijd',
                customerSatisfaction: 'Klant Tevredenheid',
                
                // Form Labels
                productIdentification: 'Product Identificatie',
                productUrl: 'Product URL',
                generateDescription: 'AI Beschrijving Genereren',
                optimizedDescription: '✨ Uw Geoptimaliseerde Productbeschrijving',
                
                // Pricing Section
                pricingTitle: '💰 Kies Uw Plan',
                pricingSubtitle: 'Ontgrendel onbeperkte AI-beschrijvingen',
                
                // Plan Names
                starter: 'Starter',
                professional: 'Professioneel',
                enterprise: 'Zakelijk',
                mostPopular: 'MEEST POPULAIR',
                
                // Plan Features
                firstMonthFree: '🎉 Eerste Maand GRATIS',
                perMonth: 'per maand',
                perMonthAfterTrial: 'per maand na proefperiode',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 beschrijvingen/maand',
                fiveBrandTones: '5 merktonen',
                seoOptimization: 'SEO optimalisatie',
                emailSupport: 'E-mail ondersteuning',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 beschrijvingen/maand',
                allBrandTones: 'Alle merktonen',
                advancedSeo: 'Geavanceerde SEO',
                bulkExport: 'Bulk export',
                prioritySupport: 'Prioriteit ondersteuning',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'Onbeperkte beschrijvingen',
                customBrandTones: 'Aangepaste merktonen',
                apiAccess: 'API toegang',
                teamCollaboration: 'Team samenwerking',
                dedicatedSupport: 'Toegewijde ondersteuning'
            },
            
            ja: {
                // Header
                pageTitle: 'SolTecSol - AI商品説明ジェネレーター',
                companyName: 'SolTecSol (ソリッドテック ソリューションズ)',
                appTitle: 'AI説明ジェネレーター',
                tagline: '商品URLを売れる文章に変換',
                subtitle: 'SEO最適化されたブランド特有の商品説明を生成し、訪問者を購入者に変換します。執筆時間を節約し、Eコマースの売上を向上させましょう。',
                
                // Generator Section
                generateSection: '🚀 説明を生成',
                monthlyUsage: '月間使用量',
                usedDescriptions: '説明使用済み',
                freeDescriptions: '無料説明使用済み',
                of: 'の',
                unlimitedDescriptions: '無制限',
                upgradePrompt: '無制限説明にアップグレード',
                trustedByLeaders: '🎯 Eコマースリーダーからの信頼',
                averageSalesIncrease: '平均売上増加',
                averageTimeSaved: '平均時間短縮',
                customerSatisfaction: '顧客満足度',
                
                // Form Labels
                productIdentification: '商品識別',
                productUrl: '商品URL',
                generateDescription: 'AI説明を生成',
                optimizedDescription: '✨ 最適化された商品説明',
                
                // Pricing Section
                pricingTitle: '💰 プランを選択',
                pricingSubtitle: '無制限のAI説明を解除',
                
                // Plan Names
                starter: 'スターター',
                professional: 'プロフェッショナル',
                enterprise: 'エンタープライズ',
                mostPopular: '最人気',
                
                // Plan Features
                firstMonthFree: '🎉 初月無料',
                perMonth: '月額',
                perMonthAfterTrial: 'トライアル期間後月額',
                
                // Starter Plan Features  
                fiftyDescriptions: '50件の説明/月',
                fiveBrandTones: '5つのブランドトーン',
                seoOptimization: 'SEO最適化',
                emailSupport: 'メールサポート',
                
                // Professional Plan Features
                twoHundredDescriptions: '200件の説明/月',
                allBrandTones: '全ブランドトーン',
                advancedSeo: '高度なSEO',
                bulkExport: '一括エクスポート',
                prioritySupport: '優先サポート',
                
                // Enterprise Plan Features
                unlimitedDescriptions: '無制限の説明',
                customBrandTones: 'カスタムブランドトーン',
                apiAccess: 'APIアクセス',
                teamCollaboration: 'チーム連携',
                dedicatedSupport: '専任サポート'
            },
            
            zh: {
                // Header
                pageTitle: 'SolTecSol - AI产品描述生成器',
                companyName: 'SolTecSol (固体科技解决方案)',
                appTitle: 'AI描述生成器',
                tagline: '将产品URL转换为转化文案',
                subtitle: '生成SEO优化的品牌特定产品描述，将访客转化为买家。节省数小时写作时间，提升电商销售。',
                
                // Generator Section
                generateSection: '🚀 生成您的描述',
                monthlyUsage: '月度使用量',
                usedDescriptions: '已使用描述',
                freeDescriptions: '已使用免费描述',
                of: '的',
                unlimitedDescriptions: '无限制',
                upgradePrompt: '升级获得无限描述',
                trustedByLeaders: '🎯 电商领导者信赖',
                averageSalesIncrease: '平均销售增长',
                averageTimeSaved: '平均节省时间',
                customerSatisfaction: '客户满意度',
                
                // Form Labels
                productIdentification: '产品识别',
                productUrl: '产品URL',
                generateDescription: '生成AI描述',
                optimizedDescription: '✨ 您的优化产品描述',
                
                // Pricing Section
                pricingTitle: '💰 选择您的计划',
                pricingSubtitle: '解锁无限AI描述',
                
                // Plan Names
                starter: '入门版',
                professional: '专业版',
                enterprise: '企业版',
                mostPopular: '最受欢迎',
                
                // Plan Features
                firstMonthFree: '🎉 首月免费',
                perMonth: '每月',
                perMonthAfterTrial: '试用期后每月',
                
                // Starter Plan Features  
                fiftyDescriptions: '50个描述/月',
                fiveBrandTones: '5种品牌语调',
                seoOptimization: 'SEO优化',
                emailSupport: '邮箱支持',
                
                // Professional Plan Features
                twoHundredDescriptions: '200个描述/月',
                allBrandTones: '所有品牌语调',
                advancedSeo: '高级SEO',
                bulkExport: '批量导出',
                prioritySupport: '优先支持',
                
                // Enterprise Plan Features
                unlimitedDescriptions: '无限描述',
                customBrandTones: '自定义品牌语调',
                apiAccess: 'API访问',
                teamCollaboration: '团队协作',
                dedicatedSupport: '专属支持'
            },
            
            ru: {
                // Header
                pageTitle: 'SolTecSol - AI Генератор Описаний Товаров',
                companyName: 'SolTecSol (Надёжные Технические Решения)',
                appTitle: 'AI Генератор Описаний',
                tagline: 'Превратите URL товаров в продающие тексты',
                subtitle: 'Создавайте SEO-оптимизированные, брендовые описания товаров, которые превращают посетителей в покупателей. Экономьте часы на написании и увеличивайте продажи интернет-магазина.',
                
                // Generator Section
                generateSection: '🚀 Создать Описание',
                monthlyUsage: 'Месячное Использование',
                usedDescriptions: 'описаний использовано',
                freeDescriptions: 'бесплатных описаний использовано',
                of: 'из',
                unlimitedDescriptions: 'неограничено',
                upgradePrompt: 'Обновить до неограниченных описаний',
                trustedByLeaders: '🎯 Доверие лидеров э-коммерции',
                averageSalesIncrease: 'Средний рост продаж',
                averageTimeSaved: 'Среднее сэкономленное время',
                customerSatisfaction: 'Удовлетворенность клиентов',
                
                // Form Labels
                productIdentification: 'Идентификация Товара',
                productUrl: 'URL Товара',
                generateDescription: 'Создать AI Описание',
                optimizedDescription: '✨ Ваше Оптимизированное Описание Товара',
                
                // Pricing Section
                pricingTitle: '💰 Выберите Ваш План',
                pricingSubtitle: 'Разблокировать неограниченные AI описания',
                
                // Plan Names
                starter: 'Стартовый',
                professional: 'Профессиональный',
                enterprise: 'Корпоративный',
                mostPopular: 'САМЫЙ ПОПУЛЯРНЫЙ',
                
                // Plan Features
                firstMonthFree: '🎉 Первый месяц БЕСПЛАТНО',
                perMonth: 'в месяц',
                perMonthAfterTrial: 'в месяц после пробного периода',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 описаний/месяц',
                fiveBrandTones: '5 брендовых тонов',
                seoOptimization: 'SEO оптимизация',
                emailSupport: 'Поддержка по email',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 описаний/месяц',
                allBrandTones: 'Все брендовые тоны',
                advancedSeo: 'Продвинутое SEO',
                bulkExport: 'Массовый экспорт',
                prioritySupport: 'Приоритетная поддержка',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'Неограниченные описания',
                customBrandTones: 'Индивидуальные брендовые тоны',
                apiAccess: 'Доступ к API',
                teamCollaboration: 'Командная работа',
                dedicatedSupport: 'Персональная поддержка'
            },
            
            ar: {
                // Header
                pageTitle: 'SolTecSol - مولد وصف المنتجات بالذكاء الاصطناعي',
                companyName: 'SolTecSol (حلول تقنية صلبة)',
                appTitle: 'مولد الوصف بالذكاء الاصطناعي',
                tagline: 'حول عناوين المنتجات إلى نصوص تسويقية',
                subtitle: 'أنتج أوصاف منتجات محسنة لمحركات البحث وخاصة بالعلامة التجارية تحول الزوار إلى مشترين. وفر ساعات من الكتابة وزد مبيعات التجارة الإلكترونية.',
                
                // Generator Section
                generateSection: '🚀 أنتج وصفك',
                monthlyUsage: 'الاستخدام الشهري',
                usedDescriptions: 'الأوصاف المستخدمة',
                freeDescriptions: 'الأوصاف المجانية المستخدمة',
                of: 'من',
                unlimitedDescriptions: 'غير محدود',
                upgradePrompt: 'ترقية للأوصاف غير المحدودة',
                trustedByLeaders: '🎯 ثقة قادة التجارة الإلكترونية',
                averageSalesIncrease: 'متوسط زيادة المبيعات',
                averageTimeSaved: 'متوسط الوقت الموفر',
                customerSatisfaction: 'رضا العملاء',
                
                // Form Labels
                productIdentification: 'تحديد المنتج',
                productUrl: 'رابط المنتج',
                generateDescription: 'إنتاج وصف بالذكاء الاصطناعي',
                optimizedDescription: '✨ وصف المنتج المحسن',
                
                // Pricing Section
                pricingTitle: '💰 اختر خطتك',
                pricingSubtitle: 'اكسب أوصاف ذكاء اصطناعي غير محدودة',
                
                // Plan Names
                starter: 'المبتدئ',
                professional: 'المحترف',
                enterprise: 'المؤسسة',
                mostPopular: 'الأكثر شعبية',
                
                // Plan Features
                firstMonthFree: '🎉 الشهر الأول مجاني',
                perMonth: 'شهرياً',
                perMonthAfterTrial: 'شهرياً بعد فترة التجربة',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 وصف/شهر',
                fiveBrandTones: '5 نبرات علامة تجارية',
                seoOptimization: 'تحسين محركات البحث',
                emailSupport: 'دعم البريد الإلكتروني',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 وصف/شهر',
                allBrandTones: 'جميع نبرات العلامة التجارية',
                advancedSeo: 'تحسين محركات البحث المتقدم',
                bulkExport: 'تصدير مجمع',
                prioritySupport: 'دعم أولوية',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'أوصاف غير محدودة',
                customBrandTones: 'نبرات علامة تجارية مخصصة',
                apiAccess: 'دخول API',
                teamCollaboration: 'تعاون الفريق',
                dedicatedSupport: 'دعم مخصص'
            },
            
            hi: {
                // Header
                pageTitle: 'SolTecSol - AI उत्पाद विवरण जेनरेटर',
                companyName: 'SolTecSol (ठोस तकनीकी समाधान)',
                appTitle: 'AI विवरण जेनरेटर',
                tagline: 'उत्पाद URLs को बिकने वाली सामग्री में बदलें',
                subtitle: 'SEO-अनुकूलित, ब्रांड-विशिष्ट उत्पाद विवरण बनाएं जो आगंतुकों को खरीदारों में बदल देते हैं। लेखन समय की घंटों की बचत करें और अपनी ई-कॉमर्स बिक्री बढ़ाएं।',
                
                // Generator Section
                generateSection: '🚀 अपना विवरण बनाएं',
                monthlyUsage: 'मासिक उपयोग',
                usedDescriptions: 'विवरण उपयोग किए गए',
                freeDescriptions: 'मुफ्त विवरण उपयोग किए गए',
                of: 'का',
                unlimitedDescriptions: 'असीमित',
                upgradePrompt: 'असीमित विवरण के लिए अपग्रेड करें',
                trustedByLeaders: '🎯 ई-कॉमर्स नेताओं द्वारा भरोसा',
                averageSalesIncrease: 'औसत बिक्री वृद्धि',
                averageTimeSaved: 'औसत समय बचत',
                customerSatisfaction: 'ग्राहक संतुष्टि',
                
                // Form Labels
                productIdentification: 'उत्पाद पहचान',
                productUrl: 'उत्पाद URL',
                generateDescription: 'AI विवरण जेनरेट करें',
                optimizedDescription: '✨ आपका अनुकूलित उत्पाद विवरण',
                
                // Pricing Section
                pricingTitle: '💰 अपनी योजना चुनें',
                pricingSubtitle: 'असीमित AI विवरण अनलॉक करें',
                
                // Plan Names
                starter: 'शुरुआती',
                professional: 'पेशेवर',
                enterprise: 'उद्यम',
                mostPopular: 'सबसे लोकप्रिय',
                
                // Plan Features
                firstMonthFree: '🎉 पहला महीना मुफ्त',
                perMonth: 'प्रति माह',
                perMonthAfterTrial: 'ट्रायल के बाद प्रति माह',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 विवरण/माह',
                fiveBrandTones: '5 ब्रांड टोन',
                seoOptimization: 'SEO अनुकूलन',
                emailSupport: 'ईमेल समर्थन',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 विवरण/माह',
                allBrandTones: 'सभी ब्रांड टोन',
                advancedSeo: 'उन्नत SEO',
                bulkExport: 'बल्क एक्सपोर्ट',
                prioritySupport: 'प्राथमिकता समर्थन',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'असीमित विवरण',
                customBrandTones: 'कस्टम ब्रांड टोन',
                apiAccess: 'API एक्सेस',
                teamCollaboration: 'टीम सहयोग',
                dedicatedSupport: 'समर्पित समर्थन'
            },
            
            ko: {
                // Header
                pageTitle: 'SolTecSol - AI 제품 설명 생성기',
                companyName: 'SolTecSol (견고한 기술 솔루션)',
                appTitle: 'AI 설명 생성기',
                tagline: '제품 URL을 전환하는 카피로 변환',
                subtitle: 'SEO 최적화된 브랜드별 제품 설명을 생성하여 방문자를 구매자로 전환하세요. 작성 시간을 절약하고 전자상거래 판매를 증대하세요.',
                
                // Generator Section
                generateSection: '🚀 설명 생성하기',
                monthlyUsage: '월간 사용량',
                usedDescriptions: '사용된 설명',
                freeDescriptions: '사용된 무료 설명',
                of: '의',
                unlimitedDescriptions: '무제한',
                upgradePrompt: '무제한 설명으로 업그레이드',
                trustedByLeaders: '🎯 전자상거래 리더들의 신뢰',
                averageSalesIncrease: '평균 매출 증가',
                averageTimeSaved: '평균 시간 절약',
                customerSatisfaction: '고객 만족도',
                
                // Form Labels
                productIdentification: '제품 식별',
                productUrl: '제품 URL',
                generateDescription: 'AI 설명 생성',
                optimizedDescription: '✨ 최적화된 제품 설명',
                
                // Pricing Section
                pricingTitle: '💰 플랜 선택',
                pricingSubtitle: '무제한 AI 설명 잠금해제',
                
                // Plan Names
                starter: '스타터',
                professional: '프로페셔널',
                enterprise: '엔터프라이즈',
                mostPopular: '가장 인기',
                
                // Plan Features
                firstMonthFree: '🎉 첫 달 무료',
                perMonth: '월',
                perMonthAfterTrial: '체험 기간 후 월',
                
                // Starter Plan Features  
                fiftyDescriptions: '50개 설명/월',
                fiveBrandTones: '5개 브랜드 톤',
                seoOptimization: 'SEO 최적화',
                emailSupport: '이메일 지원',
                
                // Professional Plan Features
                twoHundredDescriptions: '200개 설명/월',
                allBrandTones: '모든 브랜드 톤',
                advancedSeo: '고급 SEO',
                bulkExport: '일괄 내보내기',
                prioritySupport: '우선 지원',
                
                // Enterprise Plan Features
                unlimitedDescriptions: '무제한 설명',
                customBrandTones: '사용자 정의 브랜드 톤',
                apiAccess: 'API 액세스',
                teamCollaboration: '팀 협업',
                dedicatedSupport: '전용 지원'
            }
        };

        // User state object
        let userState = {
            userId: null
        };

        // Global variables for product identification
        let currentProductInfo = null;
        let inputMode = 'url'; // 'url' or 'barcode'
        

        // Global error handler
        window.addEventListener('unhandledrejection', function(event) {
            console.error('Unhandled promise rejection:', event.reason);
            if (typeof showNotification === 'function') {
                showNotification('An unexpected error occurred. Please try again.', 'error');
            }
        });

        window.addEventListener('error', function(event) {
            console.error('Global error:', event.error);
            if (typeof showNotification === 'function') {
                showNotification('An unexpected error occurred. Please refresh the page.', 'error');
            }
        });

        // Translation system
        function t(key) {
            return translations[currentLanguage]?.[key] || translations.en[key] || key;
        }
        
        function toggleLanguageDropdown() {
            const dropdown = document.getElementById('languageDropdown');
            dropdown.style.display = dropdown.style.display === 'none' || dropdown.style.display === '' ? 'block' : 'none';
        }
        
        function selectLanguage(langCode) {
            changeLanguage(langCode);
            document.getElementById('languageDropdown').style.display = 'none';
            updateLanguageDisplay(langCode);
        }
        
        function updateLanguageDisplay(langCode) {
            const languages = {
                en: { flag: '🇺🇸', name: 'English' },
                es: { flag: '🇪🇸', name: 'Español' },
                fr: { flag: '🇫🇷', name: 'Français' },
                de: { flag: '🇩🇪', name: 'Deutsch' },
                it: { flag: '🇮🇹', name: 'Italiano' },
                pt: { flag: '🇵🇹', name: 'Português' },
                nl: { flag: '🇳🇱', name: 'Nederlands' },
                ja: { flag: '🇯🇵', name: '日本語' },
                zh: { flag: '🇨🇳', name: '中文' },
                ru: { flag: '🇷🇺', name: 'Русский' },
                ar: { flag: '🇸🇦', name: 'العربية' },
                hi: { flag: '🇮🇳', name: 'हिन्दी' },
                ko: { flag: '🇰🇷', name: '한국어' }
            };
            
            if (languages[langCode]) {
                document.getElementById('currentLanguageFlag').textContent = languages[langCode].flag;
                document.getElementById('currentLanguageName').textContent = languages[langCode].name;
            }
        }
        
        function changeLanguage(langCode) {
            currentLanguage = langCode;
            localStorage.setItem('preferredLanguage', langCode);
            updateAllTranslations();
            updatePageTitle();
        }
        
        function loadLanguagePreference() {
            const savedLang = localStorage.getItem('preferredLanguage') || 'en';
            currentLanguage = savedLang;
            updateLanguageDisplay(savedLang);
        }
        
        function updatePageTitle() {
            document.title = t('pageTitle');
        }
        
        function updateAllTranslations() {
            // Update all elements with data-translate attributes
            const elements = document.querySelectorAll('[data-translate]');
            elements.forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
            
            // Update placeholders
            const placeholders = document.querySelectorAll('[data-translate-placeholder]');
            placeholders.forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.placeholder = translations[currentLanguage][key];
                }
            });
            
            // Update page title
            updatePageTitle();
            
            // Usage display managed server-side
        }

        // Close language dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('languageDropdown');
            const toggle = document.getElementById('languageToggle');
            if (dropdown && toggle && !toggle.contains(event.target) && !dropdown.contains(event.target)) {
                dropdown.style.display = 'none';
            }
        });

        // Initialize app when DOM is ready and Firebase is available
        document.addEventListener('DOMContentLoaded', async function() {
            loadLanguagePreference();
            setupEventListeners();
            updateAllTranslations(); // Apply translations after everything is loaded
            
            
            addEntranceAnimations();
        });

        // Initialize Firebase-dependent features when Firebase is ready
        window.addEventListener('firebaseReady', async function() {
            await loadUserState(); // Now async, includes server sync
        });

        function isLocalStorageAvailable() {
            try {
                const test = '__localStorage_test__';
                localStorage.setItem(test, test);
                localStorage.removeItem(test);
                return true;
            } catch (e) {
                return false;
            }
        }

        async function loadUserState() {
            try {
                // Initialize Firebase Authentication
                await initializeFirebaseAuth();
            } catch (error) {
                console.error('Error loading user state:', error);
            }
        }

        async function initializeFirebaseAuth() {
            return new Promise((resolve, reject) => {
                const auth = window.firebaseAuth;
                if (!auth) {
                    reject(new Error('Firebase Auth not initialized'));
                    return;
                }

                // Listen for authentication state changes
                window.firebaseOnAuthStateChanged(auth, async (user) => {
                    try {
                        if (user) {
                            // User is signed in
                            console.log('User authenticated:', user.uid);
                            userState.userId = user.uid;
                            userState.isAuthenticated = true;
                            
                            // Initialize secure cookies for authenticated user
                            try {
                                await window.secureCookieManager.initializeSecureCookies();
                            } catch (error) {
                                console.error('Failed to initialize secure cookies for authenticated user:', error);
                            }
                            
                            // Sync with server using Firebase UID
                            await syncFromServer();
                        } else {
                            // No user is signed in, sign in anonymously
                            console.log('No user signed in, signing in anonymously...');
                            const result = await window.firebaseSignInAnonymously(auth);
                            console.log('Anonymous sign in successful:', result.user.uid);
                        }
                        resolve();
                    } catch (error) {
                        console.error('Firebase authentication error:', error);
                        reject(error);
                    }
                });
            });
        }

        async function syncFromServer() {
            try {
                // Ensure user is authenticated with Firebase
                if (!userState.userId || !userState.isAuthenticated) {
                    console.warn('User not authenticated, cannot sync with server');
                    return;
                }
                
                // Use centralized token manager for secure authentication
                const response = await makeAuthenticatedRequest('/.netlify/functions/firebase-user', {
                    method: 'POST',
                    body: JSON.stringify({
                        action: 'get_user',
                        userId: userState.userId
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.user) {
                        console.log('Synced user data from server:', result.user);
                    }
                }
            } catch (error) {
                console.warn('Could not sync with server, using local data:', error);
            }
        }

        function saveUserState() {
            if (!isLocalStorageAvailable()) {
                console.warn('localStorage not available, cannot save state');
                return;
            }

            try {
                // SECURITY FIX: Remove localStorage for sensitive data - server manages all user state
                // Only save non-sensitive UI preferences
                const preferencesToSave = {
                    preferredLanguage: userState.preferredLanguage || 'en'
                };
                localStorage.setItem('userPreferences', JSON.stringify(preferencesToSave));
            } catch (error) {
                console.error('Error saving user state:', error);
            }
        }

        function setupEventListeners() {
            console.log('Setting up event listeners...');
            const form = document.getElementById('descriptionForm');
            if (form) {
                console.log('Form found, adding submit listener');
                form.addEventListener('submit', handleFormSubmission);
            } else {
                console.error('Form not found!');
            }

            const copyBtn = document.getElementById('copyBtn');
            if (copyBtn) {
                copyBtn.addEventListener('click', handleCopyToClipboard);
            }

            // Input method toggle buttons
            const urlModeBtn = document.getElementById('urlModeBtn');
            const barcodeModeBtn = document.getElementById('barcodeModeBtn');
            const manualModeBtn = document.getElementById('manualModeBtn');
            
            if (urlModeBtn) {
                urlModeBtn.addEventListener('click', () => switchInputMode('url'));
            }
            
            if (barcodeModeBtn) {
                barcodeModeBtn.addEventListener('click', () => switchInputMode('barcode'));
            }
            
            if (manualModeBtn) {
                manualModeBtn.addEventListener('click', () => switchInputMode('manual'));
            }

            // Barcode lookup button
            const lookupBarcodeBtn = document.getElementById('lookupBarcodeBtn');
            if (lookupBarcodeBtn) {
                lookupBarcodeBtn.addEventListener('click', handleBarcodeLookup);
            }

        }

        function handleFormSubmission(event) {
            console.log('Form submitted!');
            event.preventDefault();
            generateDescription();
        }

        function handleCopyToClipboard() {
            const text = document.getElementById('resultsContent').textContent;
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(function() {
                    showNotification('Description copied to clipboard!', 'success');
                }).catch(function(error) {
                    console.error('Copy failed:', error);
                    fallbackCopy(text);
                });
            } else {
                fallbackCopy(text);
            }
        }

        function fallbackCopy(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showNotification('Description copied to clipboard!', 'success');
            } catch (error) {
                console.error('Fallback copy failed:', error);
                showNotification('Unable to copy text. Please copy manually.', 'error');
            }
            document.body.removeChild(textArea);
        }

        function switchInputMode(mode) {
            console.log('Switching input mode to:', mode);
            inputMode = mode;
            currentProductInfo = null;
            
            // Update button states
            const urlModeBtn = document.getElementById('urlModeBtn');
            const barcodeModeBtn = document.getElementById('barcodeModeBtn');
            const manualModeBtn = document.getElementById('manualModeBtn');
            const urlInputGroup = document.getElementById('urlInputGroup');
            const barcodeInputGroup = document.getElementById('barcodeInputGroup');
            const manualInputGroup = document.getElementById('manualInputGroup');
            const productPreview = document.getElementById('productPreview');
            
            // Remove all active states first
            urlModeBtn.classList.remove('active');
            barcodeModeBtn.classList.remove('active');
            manualModeBtn.classList.remove('active');
            urlInputGroup.classList.remove('active');
            barcodeInputGroup.classList.remove('active');
            manualInputGroup.classList.remove('active');
            
            // Set active state based on mode
            if (mode === 'url') {
                urlModeBtn.classList.add('active');
                urlInputGroup.classList.add('active');
            } else if (mode === 'barcode') {
                barcodeModeBtn.classList.add('active');
                barcodeInputGroup.classList.add('active');
            } else if (mode === 'manual') {
                manualModeBtn.classList.add('active');
                manualInputGroup.classList.add('active');
            }
            
            productPreview.style.display = 'none';
            clearErrors();
        }

        async function handleBarcodeLookup() {
            const barcodeInput = document.getElementById('productBarcode');
            const barcode = barcodeInput.value.trim();
            
            if (!barcode) {
                showError('barcodeError', 'Please enter a barcode');
                return;
            }
            
            // Validate barcode format
            if (!/^\d{8,13}$/.test(barcode.replace(/[\s-]/g, ''))) {
                showError('barcodeError', 'Please enter a valid 8-13 digit barcode');
                return;
            }
            
            const lookupBtn = document.getElementById('lookupBarcodeBtn');
            lookupBtn.disabled = true;
            lookupBtn.textContent = '🔍 Looking up...';
            
            try {
                const response = await fetch('/.netlify/functions/barcode-lookup', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ barcode })
                });
                
                const data = await response.json();
                
                if (data.success && data.product) {
                    currentProductInfo = data.product;
                    showProductPreview(data.product);
                    showNotification('Product found! Ready to generate description.', 'success');
                } else {
                    showError('barcodeError', 'Product not found in barcode databases');
                    showNotification('Product not found. You can still generate a description by filling in the details manually.', 'error');
                }
            } catch (error) {
                console.error('Barcode lookup error:', error);
                showError('barcodeError', 'Failed to lookup barcode. Please try again.');
                showNotification('Lookup failed. Please try again.', 'error');
            } finally {
                lookupBtn.disabled = false;
                lookupBtn.textContent = '🔍 Lookup Product';
            }
        }

        function showProductPreview(product) {
            const productPreview = document.getElementById('productPreview');
            const previewImage = document.getElementById('previewImage');
            const previewName = document.getElementById('previewName');
            const previewBrand = document.getElementById('previewBrand');
            const previewCategory = document.getElementById('previewCategory');
            
            previewName.textContent = product.name || 'Unknown Product';
            previewBrand.textContent = product.brand || 'Unknown Brand';
            previewCategory.textContent = product.category || 'General Product';
            
            if (product.imageUrl) {
                previewImage.src = product.imageUrl;
                previewImage.style.display = 'block';
            } else {
                previewImage.style.display = 'none';
            }
            
            productPreview.style.display = 'block';
        }



        async function syncUserToServer(userData) {
            const response = await fetch('/.netlify/functions/admin', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    action: 'sync_user',
                    password: 'demo123', // This would be better handled differently in production
                    userId: userData.userId || generateUserIdFromData(userData),
                    userData: {
                        email: userData.email || 'user@unknown.com',
                        monthlyUsage: userData.monthlyUsage || 0,
                        maxUsage: userData.maxUsage,
                        lastActive: new Date().toISOString(),
                        syncedFromClient: true
                    }
                })
            });
            
            if (!response.ok) {
                throw new Error(`Server sync failed: ${response.status}`);
            }
            
            return await response.json();
        }

        function generateUserIdFromData(userData) {
            // Use Firebase UID instead of generating random IDs
            const auth = window.firebaseAuth;
            const user = auth?.currentUser;
            if (user) {
                return user.uid;
            }
            
            // Fallback for cases where Firebase is not ready
            console.warn('Firebase user not available, using anonymous ID');
            return `anonymous_${Date.now()}`;
        }


        async function generateDescription() {
            // Get form values
            const productUrl = inputMode === 'url' ? document.getElementById('productUrl').value.trim() : null;
            const productBarcode = inputMode === 'barcode' ? document.getElementById('productBarcode').value.trim() : null;
            const productName = inputMode === 'manual' ? document.getElementById('productName').value.trim() : null;
            const brandTone = document.getElementById('brandTone').value;
            const descriptionLength = document.getElementById('descriptionLength').value;
            const language = document.getElementById('language').value;
            const targetAudience = document.getElementById('targetAudience').value.trim();
            const keyFeatures = document.getElementById('keyFeatures').value.trim();

            // Clear previous errors
            clearErrors();

            // Validation
            if (!validateInputs(productUrl, productBarcode, brandTone)) {
                return;
            }

            // Show loading state
            const generateBtn = document.getElementById('generateBtn');
            const results = document.getElementById('results');
            const resultsContent = document.getElementById('resultsContent');
            
            generateBtn.classList.add('loading');
            generateBtn.textContent = 'Generating...';
            generateBtn.disabled = true;
            results.style.display = 'none';

            try {
                // Prepare request body based on input mode
                const requestBody = {
                    brandTone,
                    descriptionLength,
                    language,
                    targetAudience,
                    keyFeatures,
                    userId: userState.userId,
                    inputMode
                };

                if (inputMode === 'url') {
                    requestBody.productUrl = productUrl;
                } else if (inputMode === 'barcode') {
                    requestBody.productInfo = currentProductInfo;
                } else if (inputMode === 'manual') {
                    // Create a manual product info object
                    requestBody.productInfo = {
                        name: productName,
                        brand: '',
                        category: '',
                        platform: 'Manual Entry',
                        productType: 'product',
                        source: 'Manual Entry'
                    };
                    requestBody.inputMode = 'barcode'; // Treat as barcode mode on backend
                }

                // SECURITY ENHANCEMENT: Use centralized token manager for API authentication
                const response = await makeAuthenticatedRequest('/.netlify/functions/generate', {
                    method: 'POST',
                    body: JSON.stringify(requestBody)
                });

                const data = await response.json();

                if (data.success && data.description) {
                    // Update usage count on backend and sync locally
                    await updateUsageCount();
                    await syncUserData();
                    
                    // Show results
                    resultsContent.textContent = data.description;
                    results.style.display = 'block';
                    results.classList.add('success-animation');
                    
                    // Scroll to results
                    results.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    
                    showNotification('Description generated successfully!', 'success');
                } else {
                    throw new Error(data.error || 'Failed to generate description');
                }

            } catch (error) {
                console.error('Error generating description:', error);

                // Check if it's a usage limit error and provide subscription guidance
                const errorMessage = error.message;
                if (errorMessage.includes('Usage limit exceeded') ||
                    errorMessage.includes('limit reached') ||
                    errorMessage.includes('upgrade') ||
                    errorMessage.includes('subscription')) {

                    showUsageLimitDialog(errorMessage);
                } else {
                    showError('productUrl', 'Failed to generate description. Please try again.');
                    showNotification('Generation failed. Please try again.', 'error');
                }
            } finally {
                // Reset button
                generateBtn.classList.remove('loading');
                generateBtn.textContent = 'Generate AI Description';
                generateBtn.disabled = false;
            }
        }

        function validateInputs(productUrl, productBarcode, brandTone) {
            let isValid = true;
            
            // Clear previous errors first
            clearErrors();
            
            // Validate based on input mode
            if (inputMode === 'url') {
                if (!productUrl || productUrl.trim() === '') {
                    showError('urlError', 'Please enter a product URL');
                    isValid = false;
                } else {
                    try {
                        const url = new URL(productUrl.trim());
                        // Additional URL validation
                        if (!['http:', 'https:'].includes(url.protocol)) {
                            throw new Error('Invalid protocol');
                        }
                    } catch (error) {
                        showError('urlError', 'Please enter a valid URL');
                        isValid = false;
                    }
                }
            } else if (inputMode === 'barcode') {
                // Barcode mode validation
                if (!currentProductInfo) {
                    showError('barcodeError', 'Please lookup a product first');
                    isValid = false;
                }
            } else if (inputMode === 'manual') {
                // Manual mode validation
                const productName = document.getElementById('productName').value.trim();
                if (!productName) {
                    showError('manualError', 'Please enter a product name');
                    isValid = false;
                }
            }
            
            // Validate brand tone
            if (!brandTone || brandTone.trim() === '') {
                showError('brandToneError', 'Please select a brand tone');
                isValid = false;
            }
            
            return isValid;
        }

        function showError(errorId, message) {
            let field = null;
            let errorDiv = null;
            
            if (errorId === 'urlError') {
                field = document.getElementById('productUrl');
                errorDiv = document.getElementById('urlError');
            } else if (errorId === 'barcodeError') {
                field = document.getElementById('productBarcode');
                errorDiv = document.getElementById('barcodeError');
            } else if (errorId === 'brandToneError') {
                field = document.getElementById('brandTone');
                errorDiv = document.getElementById('brandToneError');
            }
            
            if (field) {
                field.classList.add('error');
            }
            
            if (errorDiv) {
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
            } else {
                // Fallback for missing error divs
                console.error(`Error div not found for ${errorId}: ${message}`);
                showNotification(message, 'error');
            }
        }

        function clearErrors() {
            const errorElements = document.querySelectorAll('.error');
            errorElements.forEach(element => {
                if (element.tagName === 'DIV') {
                    element.textContent = '';
                    element.style.display = 'none';
                } else {
                    element.classList.remove('error');
                }
            });
            
            // Clear specific error divs
            const errorIds = ['urlError', 'barcodeError', 'brandToneError'];
            errorIds.forEach(errorId => {
                const errorDiv = document.getElementById(errorId);
                if (errorDiv) {
                    errorDiv.textContent = '';
                    errorDiv.style.display = 'none';
                }
            });
        }

        async function updateUsageCount() {
            // Increment usage on backend
            try {
                if (!userState.userId || !userState.isAuthenticated) {
                    return; // User not authenticated
                }
                
                // Use centralized token manager for authentication
                const response = await makeAuthenticatedRequest('/.netlify/functions/firebase-user', {
                    method: 'POST',
                    body: JSON.stringify({
                        action: 'increment_usage',
                        userId: userState.userId
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.user) {
                        console.log('Usage updated on server');
                    }
                }
            } catch (error) {
                console.log('Usage update skipped:', error.message);
            }
        }

        async function syncUserData() {
            // Sync with backend user data
            try {
                if (!userState.userId || !userState.isAuthenticated) {
                    return; // User not authenticated
                }
                
                // Use centralized token manager for authentication
                const response = await makeAuthenticatedRequest('/.netlify/functions/firebase-user', {
                    method: 'POST',
                    body: JSON.stringify({
                        action: 'get_user',
                        userId: userState.userId
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.user) {
                        console.log('User data synced from server');
                    }
                }
            } catch (error) {
                console.log('Sync skipped:', error.message);
                // Don't show error to user - sync is optional
            }
        }

        async function refreshUsage() {
            // Manual sync for users to refresh their usage data
            await syncUserData();
            showNotification('Usage data refreshed', 'success');
        }

        function updateUsageDisplay() {
            // Usage display is now managed server-side
            // This function is kept for compatibility but does nothing
        }

        function addEntranceAnimations() {
            // Add subtle entrance animations
            const sections = document.querySelectorAll('.generator-section');
            sections.forEach((section, index) => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(30px)';
                
                setTimeout(() => {
                    section.style.transition = 'all 0.8s ease';
                    section.style.opacity = '1';
                    section.style.transform = 'translateY(0)';
                }, index * 200);
            });
        }

        function showNotification(message, type = 'success') {
            // Remove existing notification if any
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }

            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            // Show notification
            setTimeout(() => notification.classList.add('show'), 100);

            // Hide notification after 4 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            }, 4000);
        }

        // Show usage limit dialog with subscription guidance
        function showUsageLimitDialog(errorMessage) {
            const dialog = document.createElement('div');
            dialog.className = 'usage-limit-dialog-overlay';
            dialog.innerHTML = `
                <div class="usage-limit-dialog">
                    <div class="dialog-header">
                        <h3>⚡ Usage Limit Reached</h3>
                        <button class="dialog-close" onclick="this.closest('.usage-limit-dialog-overlay').remove()">×</button>
                    </div>
                    <div class="dialog-body">
                        <p class="error-message">${errorMessage}</p>
                        <p class="upgrade-message">Upgrade to unlock unlimited AI-generated descriptions and boost your e-commerce success!</p>
                        <div class="dialog-actions">
                            <a href="https://subscriptions.soltecsol.com" target="_blank" class="upgrade-btn">
                                💳 View Subscription Plans
                            </a>
                            <button class="dialog-close-btn" onclick="this.closest('.usage-limit-dialog-overlay').remove()">
                                Maybe Later
                            </button>
                        </div>
                    </div>
                </div>
            `;

            // Add dialog styles if not already present
            if (!document.getElementById('usage-limit-dialog-styles')) {
                const styles = document.createElement('style');
                styles.id = 'usage-limit-dialog-styles';
                styles.textContent = `
                    .usage-limit-dialog-overlay {
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: rgba(0, 0, 0, 0.7);
                        backdrop-filter: blur(5px);
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        z-index: 10000;
                        animation: fadeIn 0.3s ease;
                    }
                    .usage-limit-dialog {
                        background: white;
                        border-radius: 16px;
                        max-width: 500px;
                        width: 90%;
                        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                        overflow: hidden;
                        animation: slideUp 0.3s ease;
                    }
                    .dialog-header {
                        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
                        color: white;
                        padding: 20px;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    }
                    .dialog-header h3 {
                        margin: 0;
                        font-size: 1.2rem;
                    }
                    .dialog-close {
                        background: none;
                        border: none;
                        color: white;
                        font-size: 24px;
                        cursor: pointer;
                        width: 30px;
                        height: 30px;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        transition: background 0.2s ease;
                    }
                    .dialog-close:hover {
                        background: rgba(255, 255, 255, 0.2);
                    }
                    .dialog-body {
                        padding: 30px;
                        text-align: center;
                    }
                    .error-message {
                        color: #e74c3c;
                        font-weight: 600;
                        margin-bottom: 15px;
                    }
                    .upgrade-message {
                        color: #2c3e50;
                        margin-bottom: 25px;
                        line-height: 1.5;
                    }
                    .dialog-actions {
                        display: flex;
                        gap: 15px;
                        justify-content: center;
                        flex-wrap: wrap;
                    }
                    .upgrade-btn {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        padding: 12px 24px;
                        border-radius: 8px;
                        text-decoration: none;
                        font-weight: 600;
                        transition: transform 0.2s ease, box-shadow 0.2s ease;
                        display: inline-flex;
                        align-items: center;
                        gap: 8px;
                    }
                    .upgrade-btn:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
                    }
                    .dialog-close-btn {
                        background: #95a5a6;
                        color: white;
                        border: none;
                        padding: 12px 24px;
                        border-radius: 8px;
                        cursor: pointer;
                        font-weight: 600;
                        transition: background 0.2s ease;
                    }
                    .dialog-close-btn:hover {
                        background: #7f8c8d;
                    }
                    @keyframes fadeIn {
                        from { opacity: 0; }
                        to { opacity: 1; }
                    }
                    @keyframes slideUp {
                        from { transform: translateY(50px); opacity: 0; }
                        to { transform: translateY(0); opacity: 1; }
                    }
                `;
                document.head.appendChild(styles);
            }

            document.body.appendChild(dialog);

            // Close on outside click
            dialog.addEventListener('click', (e) => {
                if (e.target === dialog) {
                    dialog.remove();
                }
            });
        }

        // Check for successful payment on page load
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('success') === 'true') {
            showNotification('Payment processed successfully!', 'success');

            // Clean up URL
            window.history.replaceState({}, document.title, window.location.pathname);
        }

        // SESSION 3C: Enhanced navigation with return URL support
        function openSignupWithReturn() {
            const currentUrl = window.location.href;
            const signupUrl = `https://signup.soltecsol.com?return_to=${encodeURIComponent(currentUrl)}`;
            window.open(signupUrl, '_blank', 'noopener,noreferrer');
        }

        function openSigninWithReturn() {
            const currentUrl = window.location.href;
            const signinUrl = `https://signup.soltecsol.com?tab=signin&return_to=${encodeURIComponent(currentUrl)}`;
            window.open(signinUrl, '_blank', 'noopener,noreferrer');
        }

    </script>
    
    <!-- Support Footer -->
    <footer style="background: #1e293b; padding: 20px 0; text-align: center; margin-top: 40px; border-top: 1px solid #334155;">
        <div class="container" style="max-width: 1200px; margin: 0 auto; padding: 0 20px;">
            <p style="color: #94a3b8; margin-bottom: 10px; font-size: 14px;">Need help or have questions?</p>
            <p style="margin: 0;">
                <a href="mailto:support@soltecsol.com" 
                   style="color: #60a5fa; text-decoration: none; font-weight: 600; font-size: 16px;">
                   support@soltecsol.com
                </a>
            </p>
        </div>
    </footer>
</body>
</html>
