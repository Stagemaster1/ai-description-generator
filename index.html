<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.paypal.com https://www.gstatic.com https://apis.google.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self' https://api.openai.com https://world.openfoodfacts.org https://api.upcdatabase.org https://api.barcodelookup.com https://www.paypal.com https://identitytoolkit.googleapis.com https://securetoken.googleapis.com; frame-src https://www.paypal.com;">
    <title>SolTecSol - AI Product Description Generator</title>
    <!-- PayPal SDK will be loaded dynamically via JavaScript -->
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
        import { getAuth, signInAnonymously, onAuthStateChanged, onIdTokenChanged } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';
        
        // SECURITY FIX: Load Firebase configuration securely from endpoint
        async function initializeFirebaseSecure() {
            try {
                // Fetch Firebase configuration from secure endpoint
                const response = await fetch('/.netlify/functions/firebase-config');
                
                if (!response.ok) {
                    throw new Error(`Firebase config fetch failed: ${response.status} ${response.statusText}`);
                }
                
                const firebaseConfig = await response.json();
                
                // Validate configuration
                if (!firebaseConfig.apiKey || !firebaseConfig.projectId) {
                    throw new Error('Invalid Firebase configuration received');
                }
                
                // Initialize Firebase with secure configuration
                const app = initializeApp(firebaseConfig);
                const auth = getAuth(app);
                
                // Make Firebase available globally
                window.firebaseApp = app;
                window.firebaseAuth = auth;
                window.firebaseSignInAnonymously = signInAnonymously;
                window.firebaseOnAuthStateChanged = onAuthStateChanged;
                window.firebaseOnIdTokenChanged = onIdTokenChanged;
                
                console.log('Firebase initialized securely');
                
                // Initialize centralized token management
                initializeTokenManager();
                
                // Initialize secure cookies after token manager is ready
                try {
                    await window.secureCookieManager.initializeSecureCookies();
                } catch (error) {
                    console.error('Failed to initialize secure cookies during Firebase setup:', error);
                }
                
                // Dispatch custom event to signal Firebase is ready
                window.dispatchEvent(new CustomEvent('firebaseReady'));
                
            } catch (error) {
                console.error('Firebase initialization failed:', error);
                // Show user-friendly error message
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = 'position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #ef4444; color: white; padding: 16px; border-radius: 8px; z-index: 9999; font-family: Inter, sans-serif;';
                errorDiv.textContent = 'Service temporarily unavailable. Please try again later.';
                document.body.appendChild(errorDiv);
                setTimeout(() => errorDiv.remove(), 5000);
            }
        }
        
        // Initialize Firebase securely when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeFirebaseSecure);
        } else {
            initializeFirebaseSecure();
        }
    </script>

    <!-- Cross-Domain Authentication Client -->
    <script src="./cross-domain-auth-client.js"></script>

    <!-- Centralized Token Management -->
    <script>
        // SECURITY ENHANCEMENT: Centralized Firebase token management
        class FirebaseTokenManager {
            constructor() {
                this.currentToken = null;
                this.tokenRefreshPromise = null;
                this.retryCount = 0;
                this.maxRetries = 3;
                this.retryDelay = 1000; // 1 second
            }

            // Get current Firebase ID token with automatic refresh
            async getToken(forceRefresh = false) {
                try {
                    const auth = window.firebaseAuth;
                    const user = auth?.currentUser;
                    
                    if (!user) {
                        throw new Error('User not authenticated');
                    }

                    // Use cached token if available and not forcing refresh
                    if (!forceRefresh && this.currentToken) {
                        // Check if token is still valid (not expired)
                        const tokenData = this.parseJWT(this.currentToken);
                        if (tokenData && tokenData.exp > Date.now() / 1000) {
                            return this.currentToken;
                        }
                    }

                    // Get fresh token from Firebase
                    const token = await user.getIdToken(forceRefresh);
                    this.currentToken = token;
                    this.retryCount = 0; // Reset retry count on success
                    return token;

                } catch (error) {
                    console.error('Token retrieval failed:', error);
                    
                    // Implement retry logic for token failures
                    if (this.retryCount < this.maxRetries) {
                        this.retryCount++;
                        console.log(`Retrying token fetch (${this.retryCount}/${this.maxRetries})...`);
                        await this.delay(this.retryDelay * this.retryCount);
                        return this.getToken(true); // Force refresh on retry
                    }
                    
                    throw new Error('Failed to obtain authentication token after retries');
                }
            }

            // Parse JWT token to check expiration
            parseJWT(token) {
                try {
                    const base64Url = token.split('.')[1];
                    const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                    const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                    }).join(''));
                    return JSON.parse(jsonPayload);
                } catch (error) {
                    console.warn('Failed to parse JWT token:', error);
                    return null;
                }
            }

            // Clear cached token
            clearToken() {
                this.currentToken = null;
                this.retryCount = 0;
            }

            // Utility delay function
            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // Global token manager instance
        window.tokenManager = new FirebaseTokenManager();

        // Initialize token management with automatic refresh monitoring
        function initializeTokenManager() {
            const auth = window.firebaseAuth;
            if (!auth) {
                console.error('Firebase Auth not available for token management');
                return;
            }

            // Set up automatic token refresh monitoring
            window.firebaseOnIdTokenChanged(auth, (user) => {
                if (user) {
                    console.log('Token changed - clearing cached token');
                    window.tokenManager.clearToken();
                    // Optionally preload the new token
                    window.tokenManager.getToken().catch(error => {
                        console.warn('Failed to preload new token:', error);
                    });
                } else {
                    console.log('User signed out - clearing token cache and cookies');
                    window.tokenManager.clearToken();
                    window.secureCookieManager.clearAllCookies();
                }
            });

            console.log('Token manager initialized with automatic refresh monitoring');
        }

        // SECURE COOKIE IMPLEMENTATION - Session 5 Requirements
        class SecureCookieManager {
            constructor() {
                this.isSecureContext = window.location.protocol === 'https:' || window.location.hostname === 'localhost';
            }

            // Generate CSRF token
            generateCSRFToken() {
                const array = new Uint8Array(32);
                crypto.getRandomValues(array);
                return Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');
            }

            // Generate session ID
            generateSessionId() {
                const array = new Uint8Array(16);
                crypto.getRandomValues(array);
                return Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');
            }

            // Set authentication token cookie with exact specified attributes
            setAuthTokenCookie(firebaseToken) {
                if (!firebaseToken) {
                    console.warn('Cannot set auth token cookie: no token provided');
                    return;
                }
                
                const cookieValue = `soltecsol_auth_token=${firebaseToken}; Domain=.soltecsol.com; Path=/; HttpOnly; Secure; SameSite=Lax; Max-Age=3600`;
                document.cookie = cookieValue;
                console.log('Authentication token cookie set');
            }

            // Set CSRF protection cookie with exact specified attributes
            setCSRFCookie() {
                const csrfToken = this.generateCSRFToken();
                const cookieValue = `soltecsol_csrf_token=${csrfToken}; Domain=.soltecsol.com; Path=/; Secure; SameSite=Strict; Max-Age=3600`;
                document.cookie = cookieValue;
                console.log('CSRF protection cookie set');
                return csrfToken;
            }

            // Set session management cookie with exact specified attributes
            setSessionCookie() {
                const sessionId = this.generateSessionId();
                const cookieValue = `soltecsol_session_id=${sessionId}; Domain=.soltecsol.com; Path=/; HttpOnly; Secure; SameSite=Lax; Max-Age=86400`;
                document.cookie = cookieValue;
                console.log('Session management cookie set');
                return sessionId;
            }

            // Initialize all secure cookies
            async initializeSecureCookies() {
                try {
                    // Get Firebase token for authentication cookie
                    const firebaseToken = await window.tokenManager.getToken();
                    
                    // Set all three required cookies
                    this.setAuthTokenCookie(firebaseToken);
                    const csrfToken = this.setCSRFCookie();
                    const sessionId = this.setSessionCookie();
                    
                    console.log('All secure cookies initialized successfully');
                    return { csrfToken, sessionId };
                } catch (error) {
                    console.error('Failed to initialize secure cookies:', error);
                    throw error;
                }
            }

            // Get cookie value by name
            getCookie(name) {
                const value = `; ${document.cookie}`;
                const parts = value.split(`; ${name}=`);
                if (parts.length === 2) return parts.pop().split(';').shift();
                return null;
            }

            // Clear all soltecsol cookies
            clearAllCookies() {
                const cookieNames = ['soltecsol_auth_token', 'soltecsol_csrf_token', 'soltecsol_session_id'];
                cookieNames.forEach(name => {
                    document.cookie = `${name}=; Domain=.soltecsol.com; Path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT`;
                });
                console.log('All soltecsol cookies cleared');
            }
        }

        // Global secure cookie manager instance
        window.secureCookieManager = new SecureCookieManager();

        // Test function for secure cookie implementation
        async function testSecureCookies() {
            console.log('Testing secure cookie implementation...');
            
            try {
                // Test all three cookies
                const result = await window.secureCookieManager.initializeSecureCookies();
                
                // Verify cookies were set by checking their existence
                const authCookie = window.secureCookieManager.getCookie('soltecsol_auth_token');
                const csrfCookie = window.secureCookieManager.getCookie('soltecsol_csrf_token'); 
                const sessionCookie = window.secureCookieManager.getCookie('soltecsol_session_id');
                
                console.log('Cookie Test Results:');
                console.log('- Authentication Token Cookie:', authCookie ? 'SET' : 'NOT SET');
                console.log('- CSRF Protection Cookie:', csrfCookie ? 'SET' : 'NOT SET');  
                console.log('- Session Management Cookie:', sessionCookie ? 'SET' : 'NOT SET');
                
                if (authCookie && csrfCookie && sessionCookie) {
                    console.log('✅ All secure cookies implemented successfully');
                    return true;
                } else {
                    console.error('❌ Some cookies failed to set');
                    return false;
                }
            } catch (error) {
                console.error('❌ Cookie test failed:', error);
                return false;
            }
        }

        // Make test function globally available
        window.testSecureCookies = testSecureCookies;

        // Enhanced API call wrapper with automatic token handling and retry logic
        async function makeAuthenticatedRequest(url, options = {}) {
            const maxRetries = 2;
            let attempt = 0;

            while (attempt <= maxRetries) {
                try {
                    // Get current token
                    const token = await window.tokenManager.getToken(attempt > 0); // Force refresh on retries
                    
                    // Prepare headers
                    const headers = {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`,
                        ...options.headers
                    };

                    // Make the request
                    const response = await fetch(url, {
                        ...options,
                        headers
                    });

                    // Handle authentication errors with specific handling
                    if (response.status === 401 && attempt < maxRetries) {
                        const errorData = await response.json().catch(() => ({}));
                        const errorCode = errorData.code;
                        
                        console.log(`Authentication error (${errorCode}), refreshing and retrying...`);
                        
                        // Clear token and force refresh based on error type
                        window.tokenManager.clearToken();
                        
                        // For revoked tokens, we need to re-authenticate
                        if (errorCode === 'TOKEN_REVOKED') {
                            console.warn('Token revoked, may need to re-authenticate');
                            // Force Firebase to re-authenticate
                            const auth = window.firebaseAuth;
                            if (auth && auth.currentUser) {
                                try {
                                    await auth.currentUser.reload();
                                } catch (reloadError) {
                                    console.error('Failed to reload user:', reloadError);
                                }
                            }
                        }
                        
                        attempt++;
                        continue;
                    }

                    return response;

                } catch (error) {
                    if (attempt >= maxRetries) {
                        throw error;
                    }
                    attempt++;
                    console.warn(`Request attempt ${attempt} failed, retrying...`, error);
                }
            }
        }
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #6b7280;
            min-height: 100vh;
            color: #ffffff;
            overflow-x: hidden;
        }
        
        .container {
            background: linear-gradient(135deg, #0a0f1c 0%, #1a1f2e 25%, #2d1b69 50%, #1e3a8a 75%, #0f172a 100%);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .floating-element {
            position: absolute;
            opacity: 0.1;
            animation: float 20s infinite ease-in-out;
        }

        .floating-element:nth-child(1) {
            top: 20%;
            left: 10%;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            border-radius: 50%;
            animation-delay: 0s;
        }

        .floating-element:nth-child(2) {
            top: 60%;
            right: 15%;
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #10b981, #3b82f6);
            border-radius: 30%;
            animation-delay: 7s;
        }

        .floating-element:nth-child(3) {
            bottom: 30%;
            left: 20%;
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #f59e0b, #ef4444);
            border-radius: 50%;
            animation-delay: 14s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-30px) rotate(120deg); }
            66% { transform: translateY(15px) rotate(240deg); }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header {
            text-align: center;
            padding: 60px 0;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #3b82f6, transparent);
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 800;
            color: #111827;
            margin-bottom: 20px;
            letter-spacing: -1px;
        }

        .company-name {
            font-size: 1.3rem;
            color: #1f2937;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .tagline {
            font-size: 1.3rem;
            color: #111827;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .subtitle {
            font-size: 1rem;
            color: #374151;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 60px;
            align-items: stretch;
        }

        .generator-section, .pricing-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .generator-section:hover, .pricing-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #ffffff, #cbd5e1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .usage-tracker {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .usage-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .usage-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #e2e8f0;
            font-size: 0.95rem;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: #ffffff;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        /* Improved form select styling for better readability */
        .form-select {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .form-select option {
            background: #1e293b;
            color: #ffffff;
            padding: 10px;
            border: none;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #3b82f6;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }

        .form-input::placeholder {
            color: #94a3b8;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            margin: auto;
            border: 2px solid transparent;
            border-top-color: #ffffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
        }

        @keyframes spin {
            0% { transform: translateY(-50%) rotate(0deg); }
            100% { transform: translateY(-50%) rotate(360deg); }
        }

        .results {
            margin-top: 30px;
            padding: 25px;
            background: rgba(16, 185, 129, 0.1);
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }

        .results h3 {
            color: #10b981;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .results-content {
            color: #e2e8f0;
            line-height: 1.7;
            white-space: pre-wrap;
        }

        .pricing-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            align-items: stretch;
        }

        .pricing-card {
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 14px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .pricing-card.featured {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }

        .popular-badge {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            padding: 8px;
            font-size: 0.75rem;
            font-weight: 700;
            letter-spacing: 1px;
            text-align: center;
        }

        .pricing-card:hover {
            transform: translateY(-5px);
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
        }

        .plan-name {
            font-size: 1.1rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 8px;
            margin-top: 8px;
        }

        .pricing-card .plan-name {
            margin-top: 5px;
        }

        .pricing-card.featured .plan-name {
            margin-top: 18px;
        }

        .plan-price {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, #60a5fa, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 3px;
        }

        .plan-period {
            color: #94a3b8;
            margin-bottom: 12px;
            font-size: 0.8rem;
        }

        .free-trial-badge {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.65rem;
            font-weight: 600;
            margin-bottom: 8px;
            display: inline-block;
        }

        .plan-features {
            list-style: none;
            margin-bottom: 15px;
            flex-grow: 1;
            text-align: left;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }

        .plan-features li {
            color: #cbd5e1;
            margin-bottom: 4px;
            font-size: 0.8rem;
            line-height: 1.3;
            text-align: left;
        }

        .plan-features li::before {
            content: '✓';
            color: #10b981;
            font-weight: bold;
            margin-right: 8px;
        }

        .stats-section {
            text-align: center;
            padding: 60px 0;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 24px;
            margin: 60px 0;
            backdrop-filter: blur(10px);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            margin-top: 40px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #60a5fa, #a78bfa, #fb7185);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: block;
        }

        .stat-label {
            color: #94a3b8;
            font-size: 1rem;
            margin-top: 8px;
        }

        /* Language Selector Styles */
        .language-option:hover {
            background: rgba(255,255,255,0.1) !important;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 30px;
            }

            .pricing-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .header {
                padding: 40px 0;
            }

            .logo {
                font-size: 2rem;
            }

            .tagline {
                font-size: 1.1rem;
            }

            .generator-section, .pricing-section {
                padding: 30px 20px;
            }

            .section-title {
                font-size: 1.5rem;
            }
        }

        .error {
            color: #ef4444;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .form-input.error, .form-select.error, .form-textarea.error {
            border-color: #ef4444;
        }

        .success-animation {
            animation: successPulse 0.6s ease-out;
        }

        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .input-method-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .method-btn {
            flex: 1;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: #94a3b8;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .method-btn.active {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
            color: #60a5fa;
        }

        .method-btn:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .input-group {
            display: none;
        }

        .input-group.active {
            display: block;
        }

        .barcode-lookup-btn {
            width: 100%;
            margin-top: 10px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .barcode-lookup-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .barcode-lookup-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .product-preview {
            margin-top: 15px;
            padding: 20px;
            background: rgba(16, 185, 129, 0.1);
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .preview-content {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .preview-image {
            flex-shrink: 0;
            width: 60px;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .preview-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .preview-details h4 {
            color: #10b981;
            margin-bottom: 5px;
            font-size: 1rem;
        }

        .preview-details p {
            color: #cbd5e1;
            font-size: 0.9rem;
            margin-bottom: 3px;
        }

        .paypal-button-container {
            margin-top: 15px;
            display: none;
        }

        .paypal-button-container.show {
            display: block;
        }

        .clickable-plan {
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .clickable-plan:hover {
            transform: translateY(-2px);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, #10b981, #059669);
        }

       .notification.error {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }


        .plan-choose-btn {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
    </div>

    <header class="header">
        <div style="position: absolute; top: 20px; right: 20px;">
            <div class="language-selector" style="position: relative;">
                <button id="languageToggle" onclick="toggleLanguageDropdown()" style="
                    background: rgba(0,0,0,0.8);
                    border: 1px solid rgba(255,255,255,0.3);
                    border-radius: 8px;
                    color: #ffffff;
                    padding: 8px 12px;
                    font-size: 0.9rem;
                    cursor: pointer;
                    backdrop-filter: blur(10px);
                    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                    display: flex;
                    align-items: center;
                    gap: 8px;
                ">
                    <span id="currentLanguageFlag">🇺🇸</span>
                    <span id="currentLanguageName">English</span>
                    <span style="font-size: 0.7rem;">▼</span>
                </button>
                
                <div id="languageDropdown" style="
                    position: absolute;
                    top: 100%;
                    right: 0;
                    background: rgba(0,0,0,0.9);
                    border: 1px solid rgba(255,255,255,0.3);
                    border-radius: 8px;
                    backdrop-filter: blur(15px);
                    box-shadow: 0 8px 25px rgba(0,0,0,0.4);
                    min-width: 180px;
                    z-index: 9999;
                    display: none;
                    margin-top: 5px;
                ">
                    <div class="language-option" onclick="selectLanguage('en')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇺🇸</span> English
                    </div>
                    <div class="language-option" onclick="selectLanguage('es')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇪🇸</span> Español
                    </div>
                    <div class="language-option" onclick="selectLanguage('fr')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇫🇷</span> Français
                    </div>
                    <div class="language-option" onclick="selectLanguage('de')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇩🇪</span> Deutsch
                    </div>
                    <div class="language-option" onclick="selectLanguage('it')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇮🇹</span> Italiano
                    </div>
                    <div class="language-option" onclick="selectLanguage('pt')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇵🇹</span> Português
                    </div>
                    <div class="language-option" onclick="selectLanguage('nl')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇳🇱</span> Nederlands
                    </div>
                    <div class="language-option" onclick="selectLanguage('ja')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇯🇵</span> 日本語
                    </div>
                    <div class="language-option" onclick="selectLanguage('zh')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇨🇳</span> 中文
                    </div>
                    <div class="language-option" onclick="selectLanguage('ru')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇷🇺</span> Русский
                    </div>
                    <div class="language-option" onclick="selectLanguage('ar')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇸🇦</span> العربية
                    </div>
                    <div class="language-option" onclick="selectLanguage('hi')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇮🇳</span> हिन्दी
                    </div>
                    <div class="language-option" onclick="selectLanguage('ko')" style="padding: 10px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #ffffff; font-size: 0.9rem;">
                        <span>🇰🇷</span> 한국어
                    </div>
                </div>
            </div>
        </div>
        
        <div class="company-name">SolTecSol - Solid Tech Solutions</div>
        <h1 class="logo" data-translate="appTitle">AI Description Generator</h1>
        <p class="tagline" data-translate="tagline">Transform Product URLs into Converting Copy</p>
        <p class="subtitle" data-translate="subtitle">Generate SEO-optimized, brand-specific product descriptions that convert browsers into buyers. Save hours of writing time and boost your e-commerce sales.</p>
    </header>

    <div class="container">

        <div class="main-content">
            <div class="generator-section">
                <h2 class="section-title" data-translate="generateSection">🚀 Generate Your Description</h2>
                
                <div class="usage-tracker" id="usageTracker">
                    <div style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 5px; display: flex; align-items: center; justify-content: space-between;">
                        <span data-translate="monthlyUsage">Monthly Usage</span>
                        <button onclick="refreshUsage()" style="background: none; border: none; color: #94a3b8; cursor: pointer; padding: 2px; font-size: 0.8rem;" title="Refresh usage data">🔄</button>
                    </div>
                    <div style="color: #ffffff; font-weight: 600;" id="usageText">0 of 5 free descriptions used</div>
                    <div class="usage-bar">
                        <div class="usage-fill" id="usageFill" style="width: 0%;"></div>
                    </div>
                    <div style="color: #94a3b8; font-size: 0.8rem; margin-top: 5px;">
                        <span id="upgradePrompt">Upgrade for unlimited descriptions</span>
                    </div>
                </div>
                
                <form id="descriptionForm">
                    <div class="form-group">
                        <label class="form-label" data-translate="productIdentification">Product Identification</label>
                        <div class="input-method-selector">
                            <button type="button" id="urlModeBtn" class="method-btn active" data-translate="productURL">🔗 Product URL</button>
                            <button type="button" id="barcodeModeBtn" class="method-btn" data-translate="barcodeUPC">📊 Barcode/UPC</button>
                            <button type="button" id="manualModeBtn" class="method-btn" data-translate="manualEntry">✏️ Manual Entry</button>
                        </div>
                        
                        <div id="urlInputGroup" class="input-group active">
                            <input 
                                type="url" 
                                id="productUrl" 
                                class="form-input" 
                                placeholder="https://www.aliexpress.com/item/..." 
                                data-translate-placeholder="productUrlPlaceholder"
                            >
                            <div class="error" id="urlError"></div>
                        </div>
                        
                        <div id="barcodeInputGroup" class="input-group">
                            <input 
                                type="text" 
                                id="productBarcode" 
                                class="form-input" 
                                placeholder="Enter barcode/UPC (e.g., 123456789012)" 
                                data-translate-placeholder="barcodePlaceholder"
                                pattern="[0-9]{8,13}"
                                title="Enter 8-13 digit barcode or UPC"
                            >
                            <button type="button" id="lookupBarcodeBtn" class="barcode-lookup-btn" data-translate="lookupProduct">🔍 Lookup Product</button>
                            <div class="error" id="barcodeError"></div>
                        </div>
                        
                        <div id="manualInputGroup" class="input-group">
                            <input 
                                type="text" 
                                id="productName" 
                                class="form-input" 
                                placeholder="Enter product name (e.g., 'Wireless Bluetooth Headphones')"
                                data-translate-placeholder="productNamePlaceholder"
                            >
                            <div class="error" id="manualError"></div>
                        </div>
                        
                        <div id="productPreview" class="product-preview" style="display: none;">
                            <div class="preview-content">
                                <div class="preview-image">
                                    <img id="previewImage" src="" alt="Product" />
                                </div>
                                <div class="preview-details">
                                    <h4 id="previewName">Product Name</h4>
                                    <p id="previewBrand">Brand</p>
                                    <p id="previewCategory">Category</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="brandTone" class="form-label" data-translate="brandTone">Brand Tone</label>
                        <select id="brandTone" class="form-select" required>
                            <option value="" data-translate="selectBrandVoice">Select your brand voice...</option>
                            <option value="luxury" data-translate="luxuryPremium">Luxury & Premium</option>
                            <option value="casual" data-translate="casualFriendly">Casual & Friendly</option>
                            <option value="professional" data-translate="professionalAuthoritative">Professional & Authoritative</option>
                            <option value="fun" data-translate="funQuirky">Fun & Quirky</option>
                            <option value="minimalist" data-translate="minimalistClean">Minimalist & Clean</option>
                        </select>
                        <div class="error" id="brandToneError"></div>
                    </div>

                    <div class="form-group">
                        <label for="descriptionLength" class="form-label" data-translate="descriptionLength">Description Length</label>
                        <select id="descriptionLength" class="form-select" required>
                            <option value="short" data-translate="shortLength">Short (50-100 words) - Quick & Punchy</option>
                            <option value="medium" data-translate="mediumLength">Medium (150-250 words) - Recommended</option>
                            <option value="extensive" data-translate="extensiveLength">Extensive (300-500 words) - Detailed</option>
                        </select>
                        <div class="error" id="descriptionLengthError"></div>
                    </div>

                    <div class="form-group">
                        <label for="language" class="form-label" data-translate="language">Language</label>
                        <select id="language" class="form-select" required>
                            <option value="english">🇺🇸 English</option>
                            <option value="german">🇩🇪 German (Deutsch)</option>
                            <option value="spanish">🇪🇸 Spanish (Español)</option>
                            <option value="french">🇫🇷 French (Français)</option>
                            <option value="japanese">🇯🇵 Japanese (日本語)</option>
                            <option value="italian">🇮🇹 Italian (Italiano)</option>
                            <option value="dutch">🇳🇱 Dutch (Nederlands)</option>
                            <option value="portuguese">🇵🇹 Portuguese (Português)</option>
                            <option value="korean">🇰🇷 Korean (한국어)</option>
                            <option value="russian">🇷🇺 Russian (Русский)</option>
                            <option value="arabic">🇸🇦 Arabic (العربية)</option>
                            <option value="chinese">🇨🇳 Chinese Simplified (中文)</option>
                            <option value="hindi">🇮🇳 Hindi (हिंदी)</option>
                        </select>
                        <div class="error" id="languageError"></div>
                    </div>

                    <div class="form-group">
                        <label for="targetAudience" class="form-label" data-translate="targetAudience">Target Audience (Optional)</label>
                        <input 
                            type="text" 
                            id="targetAudience" 
                            class="form-input" 
                            placeholder="e.g., busy parents, fitness enthusiasts, tech professionals"
                            data-translate-placeholder="targetAudiencePlaceholder"
                        >
                    </div>

                    <div class="form-group">
                        <label for="keyFeatures" class="form-label" data-translate="keyFeatures">Key Features to Highlight (Optional)</label>
                        <textarea 
                            id="keyFeatures" 
                            class="form-textarea" 
                            placeholder="List the most important features you want to emphasize..."
                            data-translate-placeholder="keyFeaturesPlaceholder"
                        ></textarea>
                    </div>

                    <button type="submit" class="btn-primary" id="generateBtn" data-translate="generateDescription">
                        Generate AI Description
                    </button>
                </form>

                <div id="results" class="results" style="display: none;">
                    <h3 data-translate="optimizedDescription">✨ Your Optimized Product Description</h3>
                    <div id="resultsContent" class="results-content"></div>
                    <button type="button" class="btn-primary" id="copyBtn" style="margin-top: 15px;" data-translate="copyToClipboard">
                        📋 Copy to Clipboard
                    </button>
                </div>
            </div>

            <div class="pricing-section">
                <h2 class="section-title" data-translate="pricingTitle">💰 Choose Your Plan</h2>
                
                <div class="pricing-grid">
                    <div class="pricing-card clickable-plan" data-plan="starter">
                        <div class="plan-name" data-translate="starter">Starter</div>
                        <div class="free-trial-badge" data-translate="firstMonthFree">🎉 First Month FREE</div>
                        <div class="plan-price">$19.99</div>
                        <div class="plan-period" data-translate="perMonthAfterTrial">per month after trial</div>
                        <ul class="plan-features">
                            <li data-translate="fiftyDescriptions">50 descriptions/month</li>
                            <li data-translate="fiveBrandTones">5 brand tones</li>
                            <li data-translate="seoOptimization">SEO optimization</li>
                            <li data-translate="emailSupport">Email support</li>
                        </ul>
                        <div id="paypal-starter" class="paypal-button-container"></div>
                    </div>

                    <div class="pricing-card featured clickable-plan" data-plan="professional">
                        <div class="popular-badge" data-translate="mostPopular">MOST POPULAR</div>
                        <div class="plan-name" data-translate="professional">Professional</div>
                        <div class="plan-price">$49.99</div>
                        <div class="plan-period" data-translate="perMonth">per month</div>
                        <ul class="plan-features">
                            <li data-translate="twoHundredDescriptions">200 descriptions/month</li>
                            <li data-translate="allBrandTones">All brand tones</li>
                            <li data-translate="advancedSeo">Advanced SEO</li>
                            <li data-translate="bulkExport">Bulk export</li>
                            <li data-translate="prioritySupport">Priority support</li>
                        </ul>
                        <div id="paypal-professional" class="paypal-button-container"></div>
                    </div>

                    <div class="pricing-card clickable-plan" data-plan="enterprise">
                        <div class="plan-name" data-translate="enterprise">Enterprise</div>
                        <div class="plan-price">$99.99</div>
                        <div class="plan-period" data-translate="perMonth">per month</div>
                        <ul class="plan-features">
                            <li data-translate="unlimitedDescriptions">Unlimited descriptions</li>
                            <li data-translate="customBrandTones">Custom brand tones</li>
                            <li data-translate="apiAccess">API access</li>
                            <li data-translate="teamCollaboration">Team collaboration</li>
                            <li data-translate="dedicatedSupport">Dedicated support</li>
                        </ul>
                        <div id="paypal-enterprise" class="paypal-button-container"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="stats-section">
            <h2 class="section-title" data-translate="trustedByLeaders">🎯 Trusted by E-commerce Leaders</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-number">10K+</span>
                    <span class="stat-label" data-translate="descriptionsGenerated">Descriptions Generated</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">250%</span>
                    <span class="stat-label" data-translate="averageSalesIncrease">Average Sales Increase</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">45-60min</span>
                    <span class="stat-label" data-translate="averageTimeSaved">Average Time Saved</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">98%</span>
                    <span class="stat-label" data-translate="customerSatisfaction">Customer Satisfaction</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global app state
        let currentLanguage = 'en';
        
        // Translation dictionaries
        const translations = {
            en: {
                // Header
                pageTitle: 'SolTecSol - AI Product Description Generator',
                companyName: 'SolTecSol',
                appTitle: 'AI Description Generator',
                tagline: 'Transform Product URLs into Converting Copy',
                subtitle: 'Generate SEO-optimized, brand-specific product descriptions that convert browsers into buyers. Save hours of writing time and boost your e-commerce sales.',
                
                // Generator Section
                generateSection: '🚀 Generate Your Description',
                monthlyUsage: 'Monthly Usage',
                usedDescriptions: 'descriptions used',
                freeDescriptions: 'free descriptions used',
                of: 'of',
                unlimitedDescriptions: 'unlimited',
                upgradePrompt: 'Upgrade for unlimited descriptions',
                trustedByLeaders: '🎯 Trusted by E-commerce Leaders',
                averageSalesIncrease: 'Average Sales Increase',
                averageTimeSaved: 'Average Time Saved',
                customerSatisfaction: 'Customer Satisfaction',
                
                // Input Mode Buttons
                productURL: '🔗 Product URL',
                barcodeUPC: '📊 Barcode/UPC',
                manualEntry: '✏️ Manual Entry',
                
                // Form Labels
                productIdentification: 'Product Identification',
                productUrl: 'Product URL',
                productUrlPlaceholder: 'https://example.com/product-page',
                barcodeNumber: 'Barcode/UPC Number',
                barcodePlaceholder: 'Enter barcode or UPC number',
                lookupProduct: '🔍 Lookup Product',
                productName: 'Product Name',
                productNamePlaceholder: 'Enter product name',
                brand: 'Brand',
                brandPlaceholder: 'Enter brand name',
                category: 'Category',
                categoryPlaceholder: 'e.g., Electronics, Clothing',
                brandTone: 'Brand Tone',
                descriptionLength: 'Description Length',
                language: 'Language',
                targetAudience: 'Target Audience (Optional)',
                targetAudiencePlaceholder: 'e.g., busy parents, fitness enthusiasts, tech professionals',
                keyFeatures: 'Key Features to Highlight (Optional)',
                keyFeaturesPlaceholder: 'List the most important features you want to emphasize...',
                
                // Brand Tone Options
                selectBrandVoice: 'Select your brand voice...',
                luxuryPremium: 'Luxury & Premium',
                casualFriendly: 'Casual & Friendly',
                professionalAuthoritative: 'Professional & Authoritative',
                funQuirky: 'Fun & Quirky',
                minimalistClean: 'Minimalist & Clean',
                
                // Length Options
                shortLength: 'Short (50-100 words) - Quick & Punchy',
                mediumLength: 'Medium (150-250 words) - Recommended',
                extensiveLength: 'Extensive (300-500 words) - Detailed',
                
                // Buttons
                generateDescription: 'Generate AI Description',
                copyToClipboard: '📋 Copy to Clipboard',
                
                // Results
                optimizedDescription: '✨ Your Optimized Product Description',
                
                // Pricing Section
                pricingTitle: '💰 Choose Your Plan',
                pricingSubtitle: 'Unlock unlimited AI-powered descriptions',
                
                // Plan Names
                starter: 'Starter',
                professional: 'Professional', 
                enterprise: 'Enterprise',
                mostPopular: 'MOST POPULAR',
                
                // Plan Features
                firstMonthFree: '🎉 First Month FREE',
                perMonth: 'per month',
                perMonthAfterTrial: 'per month after trial',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 descriptions/month',
                fiveBrandTones: '5 brand tones',
                seoOptimization: 'SEO optimization',
                emailSupport: 'Email support',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 descriptions/month',
                allBrandTones: 'All brand tones',
                advancedSeo: 'Advanced SEO',
                bulkExport: 'Bulk export',
                prioritySupport: 'Priority support',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'Unlimited descriptions',
                customBrandTones: 'Custom brand tones',
                apiAccess: 'API access',
                teamCollaboration: 'Team collaboration',
                dedicatedSupport: 'Dedicated support',
                
                // Plan Buttons
                currentPlan: 'Current Plan',
                choosePlan: 'Choose Plan',
                
                // Stats
                descriptionsGenerated: 'Descriptions Generated',
                happyCustomers: 'Happy Customers',
                timesSaved: 'Hours Saved',
                
                // Notifications
                descriptionCopied: 'Description copied to clipboard!',
                subscriptionSuccess: 'Successfully subscribed to',
                usageDataRefreshed: 'Usage data refreshed',
                
                // Language Switcher
                selectLanguage: 'Language'
            },
            
            es: {
                // Header
                pageTitle: 'SolTecSol - Generador de Descripciones de Productos con IA',
                companyName: 'SolTecSol (Soluciones Tecnológicas Sólidas)',
                appTitle: 'Generador de Descripciones con IA',
                tagline: 'Transforma URLs de Productos en Textos que Convierten',
                subtitle: 'Genera descripciones de productos optimizadas para SEO y específicas de marca que convierten navegadores en compradores. Ahorra horas de tiempo de escritura y aumenta tus ventas de comercio electrónico.',
                
                // Generator Section
                generateSection: '🚀 Genera Tu Descripción',
                monthlyUsage: 'Uso Mensual',
                usedDescriptions: 'descripciones utilizadas',
                freeDescriptions: 'descripciones gratuitas utilizadas',
                of: 'de',
                unlimitedDescriptions: 'ilimitadas',
                upgradePrompt: 'Actualizar para descripciones ilimitadas',
                trustedByLeaders: '🎯 Confianza de Líderes E-commerce',
                averageSalesIncrease: 'Aumento Promedio de Ventas',
                averageTimeSaved: 'Tiempo Promedio Ahorrado',
                customerSatisfaction: 'Satisfacción del Cliente',
                
                // Input Mode Buttons
                productURL: '🔗 URL del Producto',
                barcodeUPC: '📊 Código de Barras/UPC',
                manualEntry: '✏️ Entrada Manual',
                
                // Form Labels
                productIdentification: 'Identificación del Producto',
                productUrl: 'URL del Producto',
                productUrlPlaceholder: 'https://ejemplo.com/pagina-producto',
                barcodeNumber: 'Número de Código de Barras/UPC',
                barcodePlaceholder: 'Introduce código de barras o número UPC',
                lookupProduct: '🔍 Buscar Producto',
                productName: 'Nombre del Producto',
                productNamePlaceholder: 'Introduce nombre del producto',
                brand: 'Marca',
                brandPlaceholder: 'Introduce nombre de la marca',
                category: 'Categoría',
                categoryPlaceholder: 'ej., Electrónicos, Ropa',
                brandTone: 'Tono de Marca',
                descriptionLength: 'Longitud de Descripción',
                language: 'Idioma',
                targetAudience: 'Audiencia Objetivo (Opcional)',
                targetAudiencePlaceholder: 'ej., padres ocupados, entusiastas del fitness, profesionales de tecnología',
                keyFeatures: 'Características Clave a Destacar (Opcional)',
                keyFeaturesPlaceholder: 'Lista las características más importantes que quieres enfatizar...',
                
                // Brand Tone Options
                selectBrandVoice: 'Selecciona la voz de tu marca...',
                luxuryPremium: 'Lujo y Premium',
                casualFriendly: 'Casual y Amigable',
                professionalAuthoritative: 'Profesional y Autoritario',
                funQuirky: 'Divertido y Peculiar',
                minimalistClean: 'Minimalista y Limpio',
                
                // Length Options
                shortLength: 'Corta (50-100 palabras) - Rápida y Directa',
                mediumLength: 'Mediana (150-250 palabras) - Recomendada',
                extensiveLength: 'Extensa (300-500 palabras) - Detallada',
                
                // Buttons
                generateDescription: 'Generar Descripción con IA',
                copyToClipboard: '📋 Copiar al Portapapeles',
                
                // Results
                optimizedDescription: '✨ Tu Descripción de Producto Optimizada',
                
                // Pricing Section
                pricingTitle: '💰 Elige Tu Plan',
                pricingSubtitle: 'Desbloquea descripciones ilimitadas con IA',
                
                // Plan Names
                starter: 'Inicial',
                professional: 'Profesional',
                enterprise: 'Empresa',
                mostPopular: 'MÁS POPULAR',
                
                // Plan Features
                firstMonthFree: '🎉 Primer Mes GRATIS',
                perMonth: 'por mes',
                perMonthAfterTrial: 'por mes después del periodo de prueba',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 descripciones/mes',
                fiveBrandTones: '5 tonos de marca',
                seoOptimization: 'Optimización SEO',
                emailSupport: 'Soporte por email',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 descripciones/mes',
                allBrandTones: 'Todos los tonos de marca',
                advancedSeo: 'SEO Avanzado',
                bulkExport: 'Exportación masiva',
                prioritySupport: 'Soporte prioritario',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'Descripciones ilimitadas',
                customBrandTones: 'Tonos de marca personalizados',
                apiAccess: 'Acceso a API',
                teamCollaboration: 'Colaboración en equipo',
                dedicatedSupport: 'Soporte dedicado',
                
                // Plan Buttons
                currentPlan: 'Plan Actual',
                choosePlan: 'Elegir Plan',
                
                // Stats
                descriptionsGenerated: 'Descripciones Generadas',
                happyCustomers: 'Clientes Satisfechos',
                timesSaved: 'Horas Ahorradas',
                
                // Notifications
                descriptionCopied: '¡Descripción copiada al portapapeles!',
                subscriptionSuccess: 'Suscripción exitosa a',
                usageDataRefreshed: 'Datos de uso actualizados',
                
                // Language Switcher
                selectLanguage: 'Idioma'
            },
            
            fr: {
                // Header
                pageTitle: 'SolTecSol - Générateur de Descriptions de Produits IA',
                companyName: 'SolTecSol (Solutions Technologiques Solides)',
                appTitle: 'Générateur de Descriptions IA',
                tagline: 'Transformez les URLs de Produits en Textes qui Convertissent',
                subtitle: 'Générez des descriptions de produits optimisées SEO et spécifiques à la marque qui convertissent les visiteurs en acheteurs. Économisez des heures de rédaction et augmentez vos ventes e-commerce.',
                
                // Generator Section
                generateSection: '🚀 Générez Votre Description',
                monthlyUsage: 'Usage Mensuel',
                usedDescriptions: 'descriptions utilisées',
                freeDescriptions: 'descriptions gratuites utilisées',
                of: 'de',
                unlimitedDescriptions: 'illimitées',
                upgradePrompt: 'Mettre à niveau pour des descriptions illimitées',
                trustedByLeaders: '🎯 Confiance des Leaders E-commerce',
                averageSalesIncrease: 'Augmentation Moyenne des Ventes',
                averageTimeSaved: 'Temps Moyen Économisé',
                customerSatisfaction: 'Satisfaction Client',
                
                // Input Mode Buttons
                productURL: '🔗 URL du Produit',
                barcodeUPC: '📊 Code-barres/UPC',
                manualEntry: '✏️ Saisie Manuelle',
                
                // Form Labels
                productUrl: 'URL du Produit',
                productUrlPlaceholder: 'https://exemple.com/page-produit',
                barcodeNumber: 'Numéro de Code-barres/UPC',
                barcodePlaceholder: 'Entrez le code-barres ou numéro UPC',
                lookupProduct: '🔍 Rechercher Produit',
                productName: 'Nom du Produit',
                productNamePlaceholder: 'Entrez le nom du produit',
                brand: 'Marque',
                brandPlaceholder: 'Entrez le nom de la marque',
                category: 'Catégorie',
                categoryPlaceholder: 'ex., Électronique, Vêtements',
                brandTone: 'Ton de Marque',
                descriptionLength: 'Longueur de Description',
                language: 'Langue',
                targetAudience: 'Public Cible (Optionnel)',
                targetAudiencePlaceholder: 'ex., Passionnés de tech, Parents, Professionnels',
                keyFeatures: 'Caractéristiques Clés (Optionnel)',
                keyFeaturesPlaceholder: 'ex., Étanche, Garantie 5 ans, Charge rapide',
                
                // Brand Tone Options
                luxuryPremium: 'Luxe et Premium',
                casualFriendly: 'Décontracté et Amical',
                professionalAuthoritative: 'Professionnel et Autoritaire',
                playfulFun: 'Ludique et Amusant',
                minimalistClean: 'Minimaliste et Épuré',
                
                // Length Options
                shortLength: 'Courte (50-100 mots)',
                mediumLength: 'Moyenne (150-250 mots)',
                extensiveLength: 'Longue (300-500 mots)',
                
                // Buttons
                generateDescription: 'Générer Description IA',
                copyDescription: 'Copier Description',
                
                // Results
                optimizedDescription: '✨ Votre Description de Produit Optimisée',
                
                // Pricing Section
                pricingTitle: '💰 Choisissez Votre Plan',
                pricingSubtitle: 'Débloquez des descriptions IA illimitées',
                
                // Plan Names
                starter: 'Démarrage',
                professional: 'Professionnel',
                enterprise: 'Entreprise',
                mostPopular: 'LE PLUS POPULAIRE',
                
                // Plan Features
                firstMonthFree: '🎉 Premier Mois GRATUIT',
                perMonth: 'par mois',
                perMonthAfterTrial: 'par mois après la période d\'essai',
                // CACHE BUST: Updated French translations
                
                // Starter Plan Features  
                fiftyDescriptions: '50 descriptions/mois',
                fiveBrandTones: '5 tons de marque',
                seoOptimization: 'Optimisation SEO',
                emailSupport: 'Support par email',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 descriptions/mois',
                allBrandTones: 'Tous les tons de marque',
                advancedSeo: 'SEO Avancé',
                bulkExport: 'Export en masse',
                prioritySupport: 'Support prioritaire',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'Descriptions illimitées',
                customBrandTones: 'Tons de marque personnalisés',
                apiAccess: 'Accès API',
                teamCollaboration: 'Collaboration d\'équipe',
                dedicatedSupport: 'Support dédié',
                
                // Plan Buttons
                currentPlan: 'Plan Actuel',
                choosePlan: 'Choisir le Plan',
                
                // Stats
                descriptionsGenerated: 'Descriptions Générées',
                happyCustomers: 'Clients Satisfaits',
                timesSaved: 'Heures Économisées',
                
                // Notifications
                descriptionCopied: 'Description copiée dans le presse-papiers !',
                subscriptionSuccess: 'Abonnement réussi à',
                usageDataRefreshed: 'Données d\'usage actualisées',
                
                // Language Switcher
                selectLanguage: 'Langue'
            },
            
            de: {
                // Header
                pageTitle: 'SolTecSol - KI Produktbeschreibungs-Generator',
                companyName: 'SolTecSol',
                appTitle: 'KI Produktbeschreibungs-Generator',
                tagline: 'Produkt-URLs in verkaufsfördernde Texte verwandeln',
                subtitle: 'Erstellen Sie SEO-optimierte, markenspezifische Produktbeschreibungen, die Besucher in Käufer verwandeln. Sparen Sie Stunden beim Schreiben und steigern Sie Ihre E-Commerce-Verkäufe.',
                
                // Generator Section
                generateSection: '🚀 Erstellen Sie Ihre Produktbeschreibung',
                monthlyUsage: 'Monatliche Nutzung',
                usedDescriptions: 'verwendete Produktbeschreibungen',
                freeDescriptions: 'kostenlose Produktbeschreibungen verwendet',
                unlimitedDescriptions: 'unbegrenzte Produktbeschreibungen',
                upgradePrompt: 'Upgrade für unbegrenzte Produktbeschreibungen',
                trustedByLeaders: '🎯 Vertrauen von E-Commerce-Führern',
                averageSalesIncrease: 'Durchschnittliche Umsatzsteigerung',
                averageTimeSaved: 'Durchschnittlich gesparte Zeit',
                customerSatisfaction: 'Kundenzufriedenheit',
                
                // Input Mode Buttons
                productURL: '🔗 Produkt-URL',
                barcodeUPC: '📊 Barcode/UPC',
                manualEntry: '✏️ Manuelle Eingabe',
                
                // Form Labels
                productIdentification: 'Produktidentifikation',
                productUrl: 'Produkt-URL',
                productUrlPlaceholder: 'https://beispiel.com/produkt-seite',
                brandTone: 'Markenton',
                descriptionLength: 'Beschreibungslänge',
                targetAudience: 'Zielgruppe (Optional)',
                targetAudiencePlaceholder: 'z.B. beschäftigte Eltern, Fitness-Enthusiasten, Tech-Profis',
                keyFeatures: 'Wichtigste Eigenschaften (Optional)', 
                keyFeaturesPlaceholder: 'Listen Sie die wichtigsten Eigenschaften auf, die Sie betonen möchten...',
                selectBrandVoice: 'Wählen Sie Ihren Markenton...',
                shortLength: 'Kurz (50-100 Wörter) - Knapp & Prägnant',
                language: 'Sprache',
                generateDescription: 'KI-Produktbeschreibung generieren',
                optimizedDescription: '✨ Ihre optimierte Produktbeschreibung',
                
                // Pricing Section
                pricingTitle: '💰 Wählen Sie Ihren Plan',
                pricingSubtitle: 'Schalten Sie unbegrenzte KI-gestützte Beschreibungen frei',
                
                // Plan Names
                starter: 'Starter',
                professional: 'Professionell',
                enterprise: 'Unternehmen',
                mostPopular: 'AM BELIEBTESTEN',
                
                // Plan Features
                firstMonthFree: '🎉 Erster Monat KOSTENLOS',
                perMonth: 'pro Monat',
                perMonthAfterTrial: 'pro Monat nach Testphase',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 Produktbeschreibungen/Monat',
                fiveBrandTones: '5 Marken-Tonarten',
                seoOptimization: 'SEO-Optimierung',
                emailSupport: 'E-Mail-Support',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 Produktbeschreibungen/Monat',
                allBrandTones: 'Alle Marken-Tonarten',
                advancedSeo: 'Erweiterte SEO',
                bulkExport: 'Massenexport',
                prioritySupport: 'Prioritäts-Support',
                
                // Enterprise Plan Features
                unlimitedDescriptionsText: 'Unbegrenzte Produktbeschreibungen',
                customBrandTones: 'Benutzerdefinierte Marken-Tonarten',
                apiAccess: 'API-Zugang',
                teamCollaboration: 'Team-Zusammenarbeit',
                dedicatedSupport: 'Dedizierter Support',
                
                // Language Switcher
                selectLanguage: 'Sprache',
                
                // Brand Tone Options
                luxuryPremium: 'Luxuriös & Premium',
                casualFriendly: 'Lässig & Freundlich',
                professionalAuthoritative: 'Professionell & Kompetent',
                playfulFun: 'Verspielt & Spaßig',
                minimalistClean: 'Minimalistisch & Sauber'
            },
            
            it: {
                // Header
                pageTitle: 'SolTecSol - Generatore di Descrizioni Prodotto AI',
                companyName: 'SolTecSol (Soluzioni Tecnologiche Solide)',
                appTitle: 'Generatore di Descrizioni AI',
                tagline: 'Trasforma gli URL dei Prodotti in Testi che Convertono',
                subtitle: 'Genera descrizioni di prodotti ottimizzate SEO e specifiche del marchio che convertono i visitatori in acquirenti. Risparmia ore di scrittura e aumenta le vendite e-commerce.',
                
                // Generator Section
                generateSection: '🚀 Genera la Tua Descrizione',
                monthlyUsage: 'Uso Mensile',
                usedDescriptions: 'descrizioni utilizzate',
                freeDescriptions: 'descrizioni gratuite utilizzate',
                unlimitedDescriptions: 'illimitate',
                upgradePrompt: 'Aggiorna per descrizioni illimitate',
                trustedByLeaders: '🎯 Fiducia dei Leader E-commerce',
                averageSalesIncrease: 'Aumento Medio delle Vendite',
                averageTimeSaved: 'Tempo Medio Risparmiato',
                customerSatisfaction: 'Soddisfazione del Cliente',
                
                // Form Labels
                productUrl: 'URL del Prodotto',
                productUrlPlaceholder: 'https://esempio.com/pagina-prodotto',
                generateDescription: 'Genera Descrizione AI',
                optimizedDescription: '✨ La Tua Descrizione Prodotto Ottimizzata',
                
                // Pricing Section
                pricingTitle: '💰 Scegli il Tuo Piano',
                pricingSubtitle: 'Sblocca descrizioni AI illimitate',
                
                // Plan Names
                starter: 'Base',
                professional: 'Professionale',
                enterprise: 'Aziendale',
                mostPopular: 'PIÙ POPOLARE',
                
                // Plan Features
                firstMonthFree: '🎉 Primo Mese GRATUITO',
                perMonth: 'al mese',
                perMonthAfterTrial: 'al mese dopo il periodo di prova',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 descrizioni/mese',
                fiveBrandTones: '5 toni di marca',
                seoOptimization: 'Ottimizzazione SEO',
                emailSupport: 'Supporto via email',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 descrizioni/mese',
                allBrandTones: 'Tutti i toni di marca',
                advancedSeo: 'SEO Avanzato',
                bulkExport: 'Esportazione in blocco',
                prioritySupport: 'Supporto prioritario',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'Descrizioni illimitate',
                customBrandTones: 'Toni di marca personalizzati',
                apiAccess: 'Accesso API',
                teamCollaboration: 'Collaborazione di squadra',
                dedicatedSupport: 'Supporto dedicato'
            },
            
            pt: {
                // Header
                pageTitle: 'SolTecSol - Gerador de Descrições de Produtos IA',
                companyName: 'SolTecSol (Soluções Tecnológicas Sólidas)',
                appTitle: 'Gerador de Descrições IA',
                tagline: 'Transforme URLs de Produtos em Textos que Convertem',
                subtitle: 'Gere descrições de produtos otimizadas para SEO e específicas da marca que convertem visitantes em compradores. Economize horas de escrita e aumente suas vendas de e-commerce.',
                
                // Generator Section
                generateSection: '🚀 Gere Sua Descrição',
                monthlyUsage: 'Uso Mensal',
                usedDescriptions: 'descrições utilizadas',
                freeDescriptions: 'descrições gratuitas utilizadas',
                unlimitedDescriptions: 'ilimitadas',
                upgradePrompt: 'Atualizar para descrições ilimitadas',
                trustedByLeaders: '🎯 Confiança de Líderes E-commerce',
                averageSalesIncrease: 'Aumento Médio de Vendas',
                averageTimeSaved: 'Tempo Médio Economizado',
                customerSatisfaction: 'Satisfação do Cliente',
                
                // Form Labels
                productUrl: 'URL do Produto',
                productUrlPlaceholder: 'https://exemplo.com/pagina-produto',
                generateDescription: 'Gerar Descrição IA',
                optimizedDescription: '✨ Sua Descrição de Produto Otimizada',
                
                // Pricing Section
                pricingTitle: '💰 Escolha Seu Plano',
                pricingSubtitle: 'Desbloqueie descrições IA ilimitadas',
                
                // Plan Names
                starter: 'Inicial',
                professional: 'Profissional',
                enterprise: 'Empresarial',
                mostPopular: 'MAIS POPULAR',
                
                // Plan Features
                firstMonthFree: '🎉 Primeiro Mês GRÁTIS',
                perMonth: 'por mês',
                perMonthAfterTrial: 'por mês após o período de teste',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 descrições/mês',
                fiveBrandTones: '5 tons de marca',
                seoOptimization: 'Otimização SEO',
                emailSupport: 'Suporte por email',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 descrições/mês',
                allBrandTones: 'Todos os tons de marca',
                advancedSeo: 'SEO Avançado',
                bulkExport: 'Exportação em lote',
                prioritySupport: 'Suporte prioritário',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'Descrições ilimitadas',
                customBrandTones: 'Tons de marca personalizados',
                apiAccess: 'Acesso à API',
                teamCollaboration: 'Colaboração em equipe',
                dedicatedSupport: 'Suporte dedicado'
            },
            
            nl: {
                // Header
                pageTitle: 'SolTecSol - AI Productbeschrijving Generator',
                companyName: 'SolTecSol (Solide Technische Oplossingen)',
                appTitle: 'AI Beschrijving Generator',
                tagline: 'Product URLs omzetten naar Converterende Tekst',
                subtitle: 'Genereer SEO-geoptimaliseerde, merkspecifieke productbeschrijvingen die bezoekers omzetten naar kopers. Bespaar uren schrijftijd en verhoog je e-commerce verkopen.',
                
                // Generator Section
                generateSection: '🚀 Genereer Uw Beschrijving',
                monthlyUsage: 'Maandelijks Gebruik',
                usedDescriptions: 'beschrijvingen gebruikt',
                freeDescriptions: 'gratis beschrijvingen gebruikt',
                of: 'van',
                unlimitedDescriptions: 'onbeperkt',
                upgradePrompt: 'Upgrade voor onbeperkte beschrijvingen',
                trustedByLeaders: '🎯 Vertrouwd door E-commerce Leiders',
                averageSalesIncrease: 'Gemiddelde Verkoop Toename',
                averageTimeSaved: 'Gemiddeld Bespaarde Tijd',
                customerSatisfaction: 'Klant Tevredenheid',
                
                // Form Labels
                productIdentification: 'Product Identificatie',
                productUrl: 'Product URL',
                generateDescription: 'AI Beschrijving Genereren',
                optimizedDescription: '✨ Uw Geoptimaliseerde Productbeschrijving',
                
                // Pricing Section
                pricingTitle: '💰 Kies Uw Plan',
                pricingSubtitle: 'Ontgrendel onbeperkte AI-beschrijvingen',
                
                // Plan Names
                starter: 'Starter',
                professional: 'Professioneel',
                enterprise: 'Zakelijk',
                mostPopular: 'MEEST POPULAIR',
                
                // Plan Features
                firstMonthFree: '🎉 Eerste Maand GRATIS',
                perMonth: 'per maand',
                perMonthAfterTrial: 'per maand na proefperiode',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 beschrijvingen/maand',
                fiveBrandTones: '5 merktonen',
                seoOptimization: 'SEO optimalisatie',
                emailSupport: 'E-mail ondersteuning',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 beschrijvingen/maand',
                allBrandTones: 'Alle merktonen',
                advancedSeo: 'Geavanceerde SEO',
                bulkExport: 'Bulk export',
                prioritySupport: 'Prioriteit ondersteuning',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'Onbeperkte beschrijvingen',
                customBrandTones: 'Aangepaste merktonen',
                apiAccess: 'API toegang',
                teamCollaboration: 'Team samenwerking',
                dedicatedSupport: 'Toegewijde ondersteuning'
            },
            
            ja: {
                // Header
                pageTitle: 'SolTecSol - AI商品説明ジェネレーター',
                companyName: 'SolTecSol (ソリッドテック ソリューションズ)',
                appTitle: 'AI説明ジェネレーター',
                tagline: '商品URLを売れる文章に変換',
                subtitle: 'SEO最適化されたブランド特有の商品説明を生成し、訪問者を購入者に変換します。執筆時間を節約し、Eコマースの売上を向上させましょう。',
                
                // Generator Section
                generateSection: '🚀 説明を生成',
                monthlyUsage: '月間使用量',
                usedDescriptions: '説明使用済み',
                freeDescriptions: '無料説明使用済み',
                of: 'の',
                unlimitedDescriptions: '無制限',
                upgradePrompt: '無制限説明にアップグレード',
                trustedByLeaders: '🎯 Eコマースリーダーからの信頼',
                averageSalesIncrease: '平均売上増加',
                averageTimeSaved: '平均時間短縮',
                customerSatisfaction: '顧客満足度',
                
                // Form Labels
                productIdentification: '商品識別',
                productUrl: '商品URL',
                generateDescription: 'AI説明を生成',
                optimizedDescription: '✨ 最適化された商品説明',
                
                // Pricing Section
                pricingTitle: '💰 プランを選択',
                pricingSubtitle: '無制限のAI説明を解除',
                
                // Plan Names
                starter: 'スターター',
                professional: 'プロフェッショナル',
                enterprise: 'エンタープライズ',
                mostPopular: '最人気',
                
                // Plan Features
                firstMonthFree: '🎉 初月無料',
                perMonth: '月額',
                perMonthAfterTrial: 'トライアル期間後月額',
                
                // Starter Plan Features  
                fiftyDescriptions: '50件の説明/月',
                fiveBrandTones: '5つのブランドトーン',
                seoOptimization: 'SEO最適化',
                emailSupport: 'メールサポート',
                
                // Professional Plan Features
                twoHundredDescriptions: '200件の説明/月',
                allBrandTones: '全ブランドトーン',
                advancedSeo: '高度なSEO',
                bulkExport: '一括エクスポート',
                prioritySupport: '優先サポート',
                
                // Enterprise Plan Features
                unlimitedDescriptions: '無制限の説明',
                customBrandTones: 'カスタムブランドトーン',
                apiAccess: 'APIアクセス',
                teamCollaboration: 'チーム連携',
                dedicatedSupport: '専任サポート'
            },
            
            zh: {
                // Header
                pageTitle: 'SolTecSol - AI产品描述生成器',
                companyName: 'SolTecSol (固体科技解决方案)',
                appTitle: 'AI描述生成器',
                tagline: '将产品URL转换为转化文案',
                subtitle: '生成SEO优化的品牌特定产品描述，将访客转化为买家。节省数小时写作时间，提升电商销售。',
                
                // Generator Section
                generateSection: '🚀 生成您的描述',
                monthlyUsage: '月度使用量',
                usedDescriptions: '已使用描述',
                freeDescriptions: '已使用免费描述',
                of: '的',
                unlimitedDescriptions: '无限制',
                upgradePrompt: '升级获得无限描述',
                trustedByLeaders: '🎯 电商领导者信赖',
                averageSalesIncrease: '平均销售增长',
                averageTimeSaved: '平均节省时间',
                customerSatisfaction: '客户满意度',
                
                // Form Labels
                productIdentification: '产品识别',
                productUrl: '产品URL',
                generateDescription: '生成AI描述',
                optimizedDescription: '✨ 您的优化产品描述',
                
                // Pricing Section
                pricingTitle: '💰 选择您的计划',
                pricingSubtitle: '解锁无限AI描述',
                
                // Plan Names
                starter: '入门版',
                professional: '专业版',
                enterprise: '企业版',
                mostPopular: '最受欢迎',
                
                // Plan Features
                firstMonthFree: '🎉 首月免费',
                perMonth: '每月',
                perMonthAfterTrial: '试用期后每月',
                
                // Starter Plan Features  
                fiftyDescriptions: '50个描述/月',
                fiveBrandTones: '5种品牌语调',
                seoOptimization: 'SEO优化',
                emailSupport: '邮箱支持',
                
                // Professional Plan Features
                twoHundredDescriptions: '200个描述/月',
                allBrandTones: '所有品牌语调',
                advancedSeo: '高级SEO',
                bulkExport: '批量导出',
                prioritySupport: '优先支持',
                
                // Enterprise Plan Features
                unlimitedDescriptions: '无限描述',
                customBrandTones: '自定义品牌语调',
                apiAccess: 'API访问',
                teamCollaboration: '团队协作',
                dedicatedSupport: '专属支持'
            },
            
            ru: {
                // Header
                pageTitle: 'SolTecSol - AI Генератор Описаний Товаров',
                companyName: 'SolTecSol (Надёжные Технические Решения)',
                appTitle: 'AI Генератор Описаний',
                tagline: 'Превратите URL товаров в продающие тексты',
                subtitle: 'Создавайте SEO-оптимизированные, брендовые описания товаров, которые превращают посетителей в покупателей. Экономьте часы на написании и увеличивайте продажи интернет-магазина.',
                
                // Generator Section
                generateSection: '🚀 Создать Описание',
                monthlyUsage: 'Месячное Использование',
                usedDescriptions: 'описаний использовано',
                freeDescriptions: 'бесплатных описаний использовано',
                of: 'из',
                unlimitedDescriptions: 'неограничено',
                upgradePrompt: 'Обновить до неограниченных описаний',
                trustedByLeaders: '🎯 Доверие лидеров э-коммерции',
                averageSalesIncrease: 'Средний рост продаж',
                averageTimeSaved: 'Среднее сэкономленное время',
                customerSatisfaction: 'Удовлетворенность клиентов',
                
                // Form Labels
                productIdentification: 'Идентификация Товара',
                productUrl: 'URL Товара',
                generateDescription: 'Создать AI Описание',
                optimizedDescription: '✨ Ваше Оптимизированное Описание Товара',
                
                // Pricing Section
                pricingTitle: '💰 Выберите Ваш План',
                pricingSubtitle: 'Разблокировать неограниченные AI описания',
                
                // Plan Names
                starter: 'Стартовый',
                professional: 'Профессиональный',
                enterprise: 'Корпоративный',
                mostPopular: 'САМЫЙ ПОПУЛЯРНЫЙ',
                
                // Plan Features
                firstMonthFree: '🎉 Первый месяц БЕСПЛАТНО',
                perMonth: 'в месяц',
                perMonthAfterTrial: 'в месяц после пробного периода',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 описаний/месяц',
                fiveBrandTones: '5 брендовых тонов',
                seoOptimization: 'SEO оптимизация',
                emailSupport: 'Поддержка по email',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 описаний/месяц',
                allBrandTones: 'Все брендовые тоны',
                advancedSeo: 'Продвинутое SEO',
                bulkExport: 'Массовый экспорт',
                prioritySupport: 'Приоритетная поддержка',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'Неограниченные описания',
                customBrandTones: 'Индивидуальные брендовые тоны',
                apiAccess: 'Доступ к API',
                teamCollaboration: 'Командная работа',
                dedicatedSupport: 'Персональная поддержка'
            },
            
            ar: {
                // Header
                pageTitle: 'SolTecSol - مولد وصف المنتجات بالذكاء الاصطناعي',
                companyName: 'SolTecSol (حلول تقنية صلبة)',
                appTitle: 'مولد الوصف بالذكاء الاصطناعي',
                tagline: 'حول عناوين المنتجات إلى نصوص تسويقية',
                subtitle: 'أنتج أوصاف منتجات محسنة لمحركات البحث وخاصة بالعلامة التجارية تحول الزوار إلى مشترين. وفر ساعات من الكتابة وزد مبيعات التجارة الإلكترونية.',
                
                // Generator Section
                generateSection: '🚀 أنتج وصفك',
                monthlyUsage: 'الاستخدام الشهري',
                usedDescriptions: 'الأوصاف المستخدمة',
                freeDescriptions: 'الأوصاف المجانية المستخدمة',
                of: 'من',
                unlimitedDescriptions: 'غير محدود',
                upgradePrompt: 'ترقية للأوصاف غير المحدودة',
                trustedByLeaders: '🎯 ثقة قادة التجارة الإلكترونية',
                averageSalesIncrease: 'متوسط زيادة المبيعات',
                averageTimeSaved: 'متوسط الوقت الموفر',
                customerSatisfaction: 'رضا العملاء',
                
                // Form Labels
                productIdentification: 'تحديد المنتج',
                productUrl: 'رابط المنتج',
                generateDescription: 'إنتاج وصف بالذكاء الاصطناعي',
                optimizedDescription: '✨ وصف المنتج المحسن',
                
                // Pricing Section
                pricingTitle: '💰 اختر خطتك',
                pricingSubtitle: 'اكسب أوصاف ذكاء اصطناعي غير محدودة',
                
                // Plan Names
                starter: 'المبتدئ',
                professional: 'المحترف',
                enterprise: 'المؤسسة',
                mostPopular: 'الأكثر شعبية',
                
                // Plan Features
                firstMonthFree: '🎉 الشهر الأول مجاني',
                perMonth: 'شهرياً',
                perMonthAfterTrial: 'شهرياً بعد فترة التجربة',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 وصف/شهر',
                fiveBrandTones: '5 نبرات علامة تجارية',
                seoOptimization: 'تحسين محركات البحث',
                emailSupport: 'دعم البريد الإلكتروني',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 وصف/شهر',
                allBrandTones: 'جميع نبرات العلامة التجارية',
                advancedSeo: 'تحسين محركات البحث المتقدم',
                bulkExport: 'تصدير مجمع',
                prioritySupport: 'دعم أولوية',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'أوصاف غير محدودة',
                customBrandTones: 'نبرات علامة تجارية مخصصة',
                apiAccess: 'دخول API',
                teamCollaboration: 'تعاون الفريق',
                dedicatedSupport: 'دعم مخصص'
            },
            
            hi: {
                // Header
                pageTitle: 'SolTecSol - AI उत्पाद विवरण जेनरेटर',
                companyName: 'SolTecSol (ठोस तकनीकी समाधान)',
                appTitle: 'AI विवरण जेनरेटर',
                tagline: 'उत्पाद URLs को बिकने वाली सामग्री में बदलें',
                subtitle: 'SEO-अनुकूलित, ब्रांड-विशिष्ट उत्पाद विवरण बनाएं जो आगंतुकों को खरीदारों में बदल देते हैं। लेखन समय की घंटों की बचत करें और अपनी ई-कॉमर्स बिक्री बढ़ाएं।',
                
                // Generator Section
                generateSection: '🚀 अपना विवरण बनाएं',
                monthlyUsage: 'मासिक उपयोग',
                usedDescriptions: 'विवरण उपयोग किए गए',
                freeDescriptions: 'मुफ्त विवरण उपयोग किए गए',
                of: 'का',
                unlimitedDescriptions: 'असीमित',
                upgradePrompt: 'असीमित विवरण के लिए अपग्रेड करें',
                trustedByLeaders: '🎯 ई-कॉमर्स नेताओं द्वारा भरोसा',
                averageSalesIncrease: 'औसत बिक्री वृद्धि',
                averageTimeSaved: 'औसत समय बचत',
                customerSatisfaction: 'ग्राहक संतुष्टि',
                
                // Form Labels
                productIdentification: 'उत्पाद पहचान',
                productUrl: 'उत्पाद URL',
                generateDescription: 'AI विवरण जेनरेट करें',
                optimizedDescription: '✨ आपका अनुकूलित उत्पाद विवरण',
                
                // Pricing Section
                pricingTitle: '💰 अपनी योजना चुनें',
                pricingSubtitle: 'असीमित AI विवरण अनलॉक करें',
                
                // Plan Names
                starter: 'शुरुआती',
                professional: 'पेशेवर',
                enterprise: 'उद्यम',
                mostPopular: 'सबसे लोकप्रिय',
                
                // Plan Features
                firstMonthFree: '🎉 पहला महीना मुफ्त',
                perMonth: 'प्रति माह',
                perMonthAfterTrial: 'ट्रायल के बाद प्रति माह',
                
                // Starter Plan Features  
                fiftyDescriptions: '50 विवरण/माह',
                fiveBrandTones: '5 ब्रांड टोन',
                seoOptimization: 'SEO अनुकूलन',
                emailSupport: 'ईमेल समर्थन',
                
                // Professional Plan Features
                twoHundredDescriptions: '200 विवरण/माह',
                allBrandTones: 'सभी ब्रांड टोन',
                advancedSeo: 'उन्नत SEO',
                bulkExport: 'बल्क एक्सपोर्ट',
                prioritySupport: 'प्राथमिकता समर्थन',
                
                // Enterprise Plan Features
                unlimitedDescriptions: 'असीमित विवरण',
                customBrandTones: 'कस्टम ब्रांड टोन',
                apiAccess: 'API एक्सेस',
                teamCollaboration: 'टीम सहयोग',
                dedicatedSupport: 'समर्पित समर्थन'
            },
            
            ko: {
                // Header
                pageTitle: 'SolTecSol - AI 제품 설명 생성기',
                companyName: 'SolTecSol (견고한 기술 솔루션)',
                appTitle: 'AI 설명 생성기',
                tagline: '제품 URL을 전환하는 카피로 변환',
                subtitle: 'SEO 최적화된 브랜드별 제품 설명을 생성하여 방문자를 구매자로 전환하세요. 작성 시간을 절약하고 전자상거래 판매를 증대하세요.',
                
                // Generator Section
                generateSection: '🚀 설명 생성하기',
                monthlyUsage: '월간 사용량',
                usedDescriptions: '사용된 설명',
                freeDescriptions: '사용된 무료 설명',
                of: '의',
                unlimitedDescriptions: '무제한',
                upgradePrompt: '무제한 설명으로 업그레이드',
                trustedByLeaders: '🎯 전자상거래 리더들의 신뢰',
                averageSalesIncrease: '평균 매출 증가',
                averageTimeSaved: '평균 시간 절약',
                customerSatisfaction: '고객 만족도',
                
                // Form Labels
                productIdentification: '제품 식별',
                productUrl: '제품 URL',
                generateDescription: 'AI 설명 생성',
                optimizedDescription: '✨ 최적화된 제품 설명',
                
                // Pricing Section
                pricingTitle: '💰 플랜 선택',
                pricingSubtitle: '무제한 AI 설명 잠금해제',
                
                // Plan Names
                starter: '스타터',
                professional: '프로페셔널',
                enterprise: '엔터프라이즈',
                mostPopular: '가장 인기',
                
                // Plan Features
                firstMonthFree: '🎉 첫 달 무료',
                perMonth: '월',
                perMonthAfterTrial: '체험 기간 후 월',
                
                // Starter Plan Features  
                fiftyDescriptions: '50개 설명/월',
                fiveBrandTones: '5개 브랜드 톤',
                seoOptimization: 'SEO 최적화',
                emailSupport: '이메일 지원',
                
                // Professional Plan Features
                twoHundredDescriptions: '200개 설명/월',
                allBrandTones: '모든 브랜드 톤',
                advancedSeo: '고급 SEO',
                bulkExport: '일괄 내보내기',
                prioritySupport: '우선 지원',
                
                // Enterprise Plan Features
                unlimitedDescriptions: '무제한 설명',
                customBrandTones: '사용자 정의 브랜드 톤',
                apiAccess: 'API 액세스',
                teamCollaboration: '팀 협업',
                dedicatedSupport: '전용 지원'
            }
        };

        // User state object
        let userState = {
            userId: null
        };

        // Global variables for product identification
        let currentProductInfo = null;
        let inputMode = 'url'; // 'url' or 'barcode'
        
        // PayPal SDK loader - dynamically loads PayPal SDK with secure Client ID
        const PayPalLoader = {
            clientId: null,
            sdkLoaded: false,
            loadPromise: null,
            
            // Fetch PayPal Client ID from secure endpoint
            async fetchClientId() {
                try {
                    const response = await fetch('/.netlify/functions/paypal-config');
                    if (!response.ok) {
                        throw new Error('Failed to fetch PayPal configuration');
                    }
                    const data = await response.json();
                    return data.clientId;
                } catch (error) {
                    console.error('PayPal Client ID fetch error:', error);
                    throw error;
                }
            },
            
            // Dynamically inject PayPal SDK script
            async loadSDK() {
                if (this.loadPromise) {
                    return this.loadPromise;
                }
                
                this.loadPromise = new Promise(async (resolve, reject) => {
                    try {
                        // Get Client ID if not already fetched
                        if (!this.clientId) {
                            this.clientId = await this.fetchClientId();
                        }
                        
                        // Create and inject PayPal SDK script
                        const script = document.createElement('script');
                        script.src = `https://www.paypal.com/sdk/js?client-id=${this.clientId}&vault=true&intent=subscription`;
                        script.onload = () => {
                            this.sdkLoaded = true;
                            console.log('PayPal SDK loaded successfully');
                            resolve();
                        };
                        script.onerror = () => {
                            reject(new Error('Failed to load PayPal SDK'));
                        };
                        
                        document.head.appendChild(script);
                    } catch (error) {
                        reject(error);
                    }
                });
                
                return this.loadPromise;
            },
            
            // Check if PayPal SDK is ready for use
            isReady() {
                return this.sdkLoaded && window.paypal;
            }
        };

        // Global error handler
        window.addEventListener('unhandledrejection', function(event) {
            console.error('Unhandled promise rejection:', event.reason);
            if (typeof showNotification === 'function') {
                showNotification('An unexpected error occurred. Please try again.', 'error');
            }
        });

        window.addEventListener('error', function(event) {
            console.error('Global error:', event.error);
            if (typeof showNotification === 'function') {
                showNotification('An unexpected error occurred. Please refresh the page.', 'error');
            }
        });

        // Translation system
        function t(key) {
            return translations[currentLanguage]?.[key] || translations.en[key] || key;
        }
        
        function toggleLanguageDropdown() {
            const dropdown = document.getElementById('languageDropdown');
            dropdown.style.display = dropdown.style.display === 'none' || dropdown.style.display === '' ? 'block' : 'none';
        }
        
        function selectLanguage(langCode) {
            changeLanguage(langCode);
            document.getElementById('languageDropdown').style.display = 'none';
            updateLanguageDisplay(langCode);
        }
        
        function updateLanguageDisplay(langCode) {
            const languages = {
                en: { flag: '🇺🇸', name: 'English' },
                es: { flag: '🇪🇸', name: 'Español' },
                fr: { flag: '🇫🇷', name: 'Français' },
                de: { flag: '🇩🇪', name: 'Deutsch' },
                it: { flag: '🇮🇹', name: 'Italiano' },
                pt: { flag: '🇵🇹', name: 'Português' },
                nl: { flag: '🇳🇱', name: 'Nederlands' },
                ja: { flag: '🇯🇵', name: '日本語' },
                zh: { flag: '🇨🇳', name: '中文' },
                ru: { flag: '🇷🇺', name: 'Русский' },
                ar: { flag: '🇸🇦', name: 'العربية' },
                hi: { flag: '🇮🇳', name: 'हिन्दी' },
                ko: { flag: '🇰🇷', name: '한국어' }
            };
            
            if (languages[langCode]) {
                document.getElementById('currentLanguageFlag').textContent = languages[langCode].flag;
                document.getElementById('currentLanguageName').textContent = languages[langCode].name;
            }
        }
        
        function changeLanguage(langCode) {
            currentLanguage = langCode;
            localStorage.setItem('preferredLanguage', langCode);
            updateAllTranslations();
            updatePageTitle();
        }
        
        function loadLanguagePreference() {
            const savedLang = localStorage.getItem('preferredLanguage') || 'en';
            currentLanguage = savedLang;
            updateLanguageDisplay(savedLang);
        }
        
        function updatePageTitle() {
            document.title = t('pageTitle');
        }
        
        function updateAllTranslations() {
            // Update all elements with data-translate attributes
            const elements = document.querySelectorAll('[data-translate]');
            elements.forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
            
            // Update placeholders
            const placeholders = document.querySelectorAll('[data-translate-placeholder]');
            placeholders.forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.placeholder = translations[currentLanguage][key];
                }
            });
            
            // Update page title
            updatePageTitle();
            
            // Usage display managed server-side
        }

        // Close language dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('languageDropdown');
            const toggle = document.getElementById('languageToggle');
            if (dropdown && toggle && !toggle.contains(event.target) && !dropdown.contains(event.target)) {
                dropdown.style.display = 'none';
            }
        });

        // Initialize app when DOM is ready and Firebase is available
        document.addEventListener('DOMContentLoaded', async function() {
            loadLanguagePreference();
            setupEventListeners();
            updateAllTranslations(); // Apply translations after everything is loaded
            
            // Setup PayPal buttons once on page load
            setupPayPalButtons().catch(error => {
                console.error('PayPal setup failed:', error);
                showNotification('Payment system temporarily unavailable', 'error');
            });
            
            addEntranceAnimations();
        });

        // Initialize Firebase-dependent features when Firebase is ready
        window.addEventListener('firebaseReady', async function() {
            await loadUserState(); // Now async, includes server sync
        });

        function isLocalStorageAvailable() {
            try {
                const test = '__localStorage_test__';
                localStorage.setItem(test, test);
                localStorage.removeItem(test);
                return true;
            } catch (e) {
                return false;
            }
        }

        async function loadUserState() {
            try {
                // Initialize Firebase Authentication
                await initializeFirebaseAuth();
            } catch (error) {
                console.error('Error loading user state:', error);
            }
        }

        async function initializeFirebaseAuth() {
            return new Promise((resolve, reject) => {
                const auth = window.firebaseAuth;
                if (!auth) {
                    reject(new Error('Firebase Auth not initialized'));
                    return;
                }

                // Listen for authentication state changes
                window.firebaseOnAuthStateChanged(auth, async (user) => {
                    try {
                        if (user) {
                            // User is signed in
                            console.log('User authenticated:', user.uid);
                            userState.userId = user.uid;
                            userState.isAuthenticated = true;
                            
                            // Initialize secure cookies for authenticated user
                            try {
                                await window.secureCookieManager.initializeSecureCookies();
                            } catch (error) {
                                console.error('Failed to initialize secure cookies for authenticated user:', error);
                            }
                            
                            // Sync with server using Firebase UID
                            await syncFromServer();
                        } else {
                            // No user is signed in, sign in anonymously
                            console.log('No user signed in, signing in anonymously...');
                            const result = await window.firebaseSignInAnonymously(auth);
                            console.log('Anonymous sign in successful:', result.user.uid);
                        }
                        resolve();
                    } catch (error) {
                        console.error('Firebase authentication error:', error);
                        reject(error);
                    }
                });
            });
        }

        async function syncFromServer() {
            try {
                // Ensure user is authenticated with Firebase
                if (!userState.userId || !userState.isAuthenticated) {
                    console.warn('User not authenticated, cannot sync with server');
                    return;
                }
                
                // Use centralized token manager for secure authentication
                const response = await makeAuthenticatedRequest('/.netlify/functions/firebase-user', {
                    method: 'POST',
                    body: JSON.stringify({
                        action: 'get_user',
                        userId: userState.userId
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.user) {
                        console.log('Synced user data from server:', result.user);
                    }
                }
            } catch (error) {
                console.warn('Could not sync with server, using local data:', error);
            }
        }

        function saveUserState() {
            if (!isLocalStorageAvailable()) {
                console.warn('localStorage not available, cannot save state');
                return;
            }

            try {
                // SECURITY FIX: Remove localStorage for sensitive data - server manages all user state
                // Only save non-sensitive UI preferences
                const preferencesToSave = {
                    preferredLanguage: userState.preferredLanguage || 'en'
                };
                localStorage.setItem('userPreferences', JSON.stringify(preferencesToSave));
            } catch (error) {
                console.error('Error saving user state:', error);
            }
        }

        function setupEventListeners() {
            console.log('Setting up event listeners...');
            const form = document.getElementById('descriptionForm');
            if (form) {
                console.log('Form found, adding submit listener');
                form.addEventListener('submit', handleFormSubmission);
            } else {
                console.error('Form not found!');
            }

            const copyBtn = document.getElementById('copyBtn');
            if (copyBtn) {
                copyBtn.addEventListener('click', handleCopyToClipboard);
            }

            // Input method toggle buttons
            const urlModeBtn = document.getElementById('urlModeBtn');
            const barcodeModeBtn = document.getElementById('barcodeModeBtn');
            const manualModeBtn = document.getElementById('manualModeBtn');
            
            if (urlModeBtn) {
                urlModeBtn.addEventListener('click', () => switchInputMode('url'));
            }
            
            if (barcodeModeBtn) {
                barcodeModeBtn.addEventListener('click', () => switchInputMode('barcode'));
            }
            
            if (manualModeBtn) {
                manualModeBtn.addEventListener('click', () => switchInputMode('manual'));
            }

            // Barcode lookup button
            const lookupBarcodeBtn = document.getElementById('lookupBarcodeBtn');
            if (lookupBarcodeBtn) {
                lookupBarcodeBtn.addEventListener('click', handleBarcodeLookup);
            }

            // Add click handlers for pricing cards
            const pricingCards = document.querySelectorAll('.clickable-plan');
            console.log('Found pricing cards:', pricingCards.length);
            pricingCards.forEach(card => {
                card.addEventListener('click', (e) => {
                    const planType = card.getAttribute('data-plan');
                    console.log('Plan card clicked:', planType);
                    showPayPalButton(planType);
                });
            });
        }

        function handleFormSubmission(event) {
            console.log('Form submitted!');
            event.preventDefault();
            generateDescription();
        }

        function handleCopyToClipboard() {
            const text = document.getElementById('resultsContent').textContent;
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(function() {
                    showNotification('Description copied to clipboard!', 'success');
                }).catch(function(error) {
                    console.error('Copy failed:', error);
                    fallbackCopy(text);
                });
            } else {
                fallbackCopy(text);
            }
        }

        function fallbackCopy(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showNotification('Description copied to clipboard!', 'success');
            } catch (error) {
                console.error('Fallback copy failed:', error);
                showNotification('Unable to copy text. Please copy manually.', 'error');
            }
            document.body.removeChild(textArea);
        }

        function switchInputMode(mode) {
            console.log('Switching input mode to:', mode);
            inputMode = mode;
            currentProductInfo = null;
            
            // Update button states
            const urlModeBtn = document.getElementById('urlModeBtn');
            const barcodeModeBtn = document.getElementById('barcodeModeBtn');
            const manualModeBtn = document.getElementById('manualModeBtn');
            const urlInputGroup = document.getElementById('urlInputGroup');
            const barcodeInputGroup = document.getElementById('barcodeInputGroup');
            const manualInputGroup = document.getElementById('manualInputGroup');
            const productPreview = document.getElementById('productPreview');
            
            // Remove all active states first
            urlModeBtn.classList.remove('active');
            barcodeModeBtn.classList.remove('active');
            manualModeBtn.classList.remove('active');
            urlInputGroup.classList.remove('active');
            barcodeInputGroup.classList.remove('active');
            manualInputGroup.classList.remove('active');
            
            // Set active state based on mode
            if (mode === 'url') {
                urlModeBtn.classList.add('active');
                urlInputGroup.classList.add('active');
            } else if (mode === 'barcode') {
                barcodeModeBtn.classList.add('active');
                barcodeInputGroup.classList.add('active');
            } else if (mode === 'manual') {
                manualModeBtn.classList.add('active');
                manualInputGroup.classList.add('active');
            }
            
            productPreview.style.display = 'none';
            clearErrors();
        }

        async function handleBarcodeLookup() {
            const barcodeInput = document.getElementById('productBarcode');
            const barcode = barcodeInput.value.trim();
            
            if (!barcode) {
                showError('barcodeError', 'Please enter a barcode');
                return;
            }
            
            // Validate barcode format
            if (!/^\d{8,13}$/.test(barcode.replace(/[\s-]/g, ''))) {
                showError('barcodeError', 'Please enter a valid 8-13 digit barcode');
                return;
            }
            
            const lookupBtn = document.getElementById('lookupBarcodeBtn');
            lookupBtn.disabled = true;
            lookupBtn.textContent = '🔍 Looking up...';
            
            try {
                const response = await fetch('/.netlify/functions/barcode-lookup', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ barcode })
                });
                
                const data = await response.json();
                
                if (data.success && data.product) {
                    currentProductInfo = data.product;
                    showProductPreview(data.product);
                    showNotification('Product found! Ready to generate description.', 'success');
                } else {
                    showError('barcodeError', 'Product not found in barcode databases');
                    showNotification('Product not found. You can still generate a description by filling in the details manually.', 'error');
                }
            } catch (error) {
                console.error('Barcode lookup error:', error);
                showError('barcodeError', 'Failed to lookup barcode. Please try again.');
                showNotification('Lookup failed. Please try again.', 'error');
            } finally {
                lookupBtn.disabled = false;
                lookupBtn.textContent = '🔍 Lookup Product';
            }
        }

        function showProductPreview(product) {
            const productPreview = document.getElementById('productPreview');
            const previewImage = document.getElementById('previewImage');
            const previewName = document.getElementById('previewName');
            const previewBrand = document.getElementById('previewBrand');
            const previewCategory = document.getElementById('previewCategory');
            
            previewName.textContent = product.name || 'Unknown Product';
            previewBrand.textContent = product.brand || 'Unknown Brand';
            previewCategory.textContent = product.category || 'General Product';
            
            if (product.imageUrl) {
                previewImage.src = product.imageUrl;
                previewImage.style.display = 'block';
            } else {
                previewImage.style.display = 'none';
            }
            
            productPreview.style.display = 'block';
        }

        async function setupPayPalButtons() {
            try {
                // Load PayPal SDK dynamically with secure Client ID
                await PayPalLoader.loadSDK();
                
                // Check if PayPal SDK is ready
                if (!PayPalLoader.isReady()) {
                    throw new Error('PayPal SDK not ready');
                }
                
                // Fetch plan IDs from backend
                const planResponse = await fetch('/.netlify/functions/paypal', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'get_plan_ids' })
                });
                
                if (!planResponse.ok) {
                    throw new Error('Failed to fetch PayPal plan IDs');
                }
                
                const planIds = await planResponse.json();
                console.log('Retrieved plan IDs:', planIds);
                
                // PayPal Starter Subscription  
                paypal.Buttons({
                    createSubscription: function(data, actions) {
                        return actions.subscription.create({
                            'plan_id': planIds.starter
                        });
                    },
                    onApprove: function(data, actions) {
                        alert('Subscription successful!');
                        console.log('Subscription ID:', data.subscriptionID);
                    },
                    onError: function(err) {
                        console.error('PayPal Subscription Error:', err);
                        alert('Subscription failed');
                    }
                }).render('#paypal-starter');

                // PayPal Professional Plan
                paypal.Buttons({
                    style: {
                        color: 'blue',
                        shape: 'rect',
                        label: 'subscribe'
                    },
                    createSubscription: function(data, actions) {
                        return actions.subscription.create({
                            'plan_id': planIds.professional
                        });
                    },
                    onApprove: function(data, actions) {
                        handlePayPalSuccess('professional', data.subscriptionID);
                    },
                    onError: function(err) {
                        console.error('PayPal Error:', err);
                        showNotification('Payment failed. Please try again.', 'error');
                    }
                }).render('#paypal-professional');

                // PayPal Enterprise Plan
                paypal.Buttons({
                    style: {
                        color: 'blue',
                        shape: 'rect',
                        label: 'subscribe'
                    },
                    createSubscription: function(data, actions) {
                        return actions.subscription.create({
                            'plan_id': planIds.enterprise
                        });
                    },
                    onApprove: function(data, actions) {
                        handlePayPalSuccess('enterprise', data.subscriptionID);
                    },
                    onError: function(err) {
                        console.error('PayPal Error:', err);
                        showNotification('Payment failed. Please try again.', 'error');
                    }
                }).render('#paypal-enterprise');
            } catch (error) {
                console.error('PayPal setup failed:', error);
                showNotification('Payment system unavailable. Please try again later.', 'error');
            }
        }

        async function handlePayPalSuccess(planName, subscriptionId) {
            showNotification('Processing your subscription...', 'info');
            
            try {
                // Get Firebase authentication token
                const auth = window.firebaseAuth;
                const user = auth?.currentUser;
                if (!user) {
                    throw new Error('User not authenticated');
                }
                
                const idToken = await user.getIdToken();
                
                // Send subscription data to server for processing
                const response = await fetch('/.netlify/functions/firebase-user', {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${idToken}`
                    },
                    body: JSON.stringify({
                        action: 'verify_subscription',
                        userId: userState.userId,
                        planName: planName,
                        subscriptionId: subscriptionId,
                        paymentProvider: 'paypal'
                    })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        showNotification(`Successfully subscribed to ${planName.charAt(0).toUpperCase() + planName.slice(1)} plan!`, 'success');
                    } else {
                        throw new Error(result.error || 'Subscription processing failed');
                    }
                } else {
                    throw new Error('Server processing failed');
                }
            } catch (error) {
                console.error('Subscription processing error:', error);
                showNotification('Subscription processing failed. Please contact support.', 'error');
            }
        }

        async function syncUserToServer(userData) {
            const response = await fetch('/.netlify/functions/admin', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    action: 'sync_user',
                    password: 'demo123', // This would be better handled differently in production
                    userId: userData.userId || generateUserIdFromData(userData),
                    userData: {
                        email: userData.email || 'subscriber@unknown.com',
                        subscriptionType: userData.subscriptionType,
                        monthlyUsage: userData.monthlyUsage || 0,
                        maxUsage: userData.maxUsage,
                        isSubscribed: userData.isSubscribed,
                        subscriptionId: userData.subscriptionId,
                        lastActive: new Date().toISOString(),
                        syncedFromClient: true
                    }
                })
            });
            
            if (!response.ok) {
                throw new Error(`Server sync failed: ${response.status}`);
            }
            
            return await response.json();
        }

        function generateUserIdFromData(userData) {
            // Use Firebase UID instead of generating random IDs
            const auth = window.firebaseAuth;
            const user = auth?.currentUser;
            if (user) {
                return user.uid;
            }
            
            // Fallback for cases where Firebase is not ready
            console.warn('Firebase user not available, using subscription-based ID');
            return `paypal_${userData.subscriptionId || 'unknown'}`;
        }

        async function handlePaymentButtonClick(button) {
            try {
                const planName = button.getAttribute('data-plan');
                const price = button.getAttribute('data-price');
                const limit = parseInt(button.getAttribute('data-limit'));

                if (!planName || !price || !limit) {
                    console.error('Missing payment button data attributes');
                    return;
                }

                // Show loading state
                button.disabled = true;
                button.textContent = 'Processing...';

                // Create checkout session
                const response = await fetch('/.netlify/functions/stripe', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'create_checkout_session',
                        planName: planName,
                        email: userState.email || ''
                    })
                });

                const data = await response.json();

                if (data.checkout_url) {
                    // Redirect to Stripe Checkout
                    window.location.href = data.checkout_url;
                } else {
                    throw new Error(data.error || 'Failed to create checkout session');
                }

            } catch (error) {
                console.error('Payment button click error:', error);
                showNotification('Payment processing error. Please try again.', 'error');
                
                // Reset button
                button.disabled = false;
                const originalText = button.getAttribute('data-plan') === 'starter' ? 'Start Free Trial' : 
                                   button.getAttribute('data-plan') === 'professional' ? 'Choose Professional' : 
                                   'Choose Enterprise';
                button.textContent = originalText;
            }
        }

        async function generateDescription() {
            // Get form values
            const productUrl = inputMode === 'url' ? document.getElementById('productUrl').value.trim() : null;
            const productBarcode = inputMode === 'barcode' ? document.getElementById('productBarcode').value.trim() : null;
            const productName = inputMode === 'manual' ? document.getElementById('productName').value.trim() : null;
            const brandTone = document.getElementById('brandTone').value;
            const descriptionLength = document.getElementById('descriptionLength').value;
            const language = document.getElementById('language').value;
            const targetAudience = document.getElementById('targetAudience').value.trim();
            const keyFeatures = document.getElementById('keyFeatures').value.trim();

            // Clear previous errors
            clearErrors();

            // Validation
            if (!validateInputs(productUrl, productBarcode, brandTone)) {
                return;
            }

            // Show loading state
            const generateBtn = document.getElementById('generateBtn');
            const results = document.getElementById('results');
            const resultsContent = document.getElementById('resultsContent');
            
            generateBtn.classList.add('loading');
            generateBtn.textContent = 'Generating...';
            generateBtn.disabled = true;
            results.style.display = 'none';

            try {
                // Prepare request body based on input mode
                const requestBody = {
                    brandTone,
                    descriptionLength,
                    language,
                    targetAudience,
                    keyFeatures,
                    userId: userState.userId,
                    inputMode
                };

                if (inputMode === 'url') {
                    requestBody.productUrl = productUrl;
                } else if (inputMode === 'barcode') {
                    requestBody.productInfo = currentProductInfo;
                } else if (inputMode === 'manual') {
                    // Create a manual product info object
                    requestBody.productInfo = {
                        name: productName,
                        brand: '',
                        category: '',
                        platform: 'Manual Entry',
                        productType: 'product',
                        source: 'Manual Entry'
                    };
                    requestBody.inputMode = 'barcode'; // Treat as barcode mode on backend
                }

                // SECURITY ENHANCEMENT: Use centralized token manager for API authentication
                const response = await makeAuthenticatedRequest('/.netlify/functions/generate', {
                    method: 'POST',
                    body: JSON.stringify(requestBody)
                });

                const data = await response.json();

                if (data.success && data.description) {
                    // Update usage count on backend and sync locally
                    await updateUsageCount();
                    await syncUserData();
                    
                    // Show results
                    resultsContent.textContent = data.description;
                    results.style.display = 'block';
                    results.classList.add('success-animation');
                    
                    // Scroll to results
                    results.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    
                    showNotification('Description generated successfully!', 'success');
                } else {
                    throw new Error(data.error || 'Failed to generate description');
                }
                
            } catch (error) {
                console.error('Error generating description:', error);
                showError('productUrl', 'Failed to generate description. Please try again.');
                showNotification('Generation failed. Please try again.', 'error');
            } finally {
                // Reset button
                generateBtn.classList.remove('loading');
                generateBtn.textContent = 'Generate AI Description';
                generateBtn.disabled = false;
            }
        }

        function validateInputs(productUrl, productBarcode, brandTone) {
            let isValid = true;
            
            // Clear previous errors first
            clearErrors();
            
            // Validate based on input mode
            if (inputMode === 'url') {
                if (!productUrl || productUrl.trim() === '') {
                    showError('urlError', 'Please enter a product URL');
                    isValid = false;
                } else {
                    try {
                        const url = new URL(productUrl.trim());
                        // Additional URL validation
                        if (!['http:', 'https:'].includes(url.protocol)) {
                            throw new Error('Invalid protocol');
                        }
                    } catch (error) {
                        showError('urlError', 'Please enter a valid URL');
                        isValid = false;
                    }
                }
            } else if (inputMode === 'barcode') {
                // Barcode mode validation
                if (!currentProductInfo) {
                    showError('barcodeError', 'Please lookup a product first');
                    isValid = false;
                }
            } else if (inputMode === 'manual') {
                // Manual mode validation
                const productName = document.getElementById('productName').value.trim();
                if (!productName) {
                    showError('manualError', 'Please enter a product name');
                    isValid = false;
                }
            }
            
            // Validate brand tone
            if (!brandTone || brandTone.trim() === '') {
                showError('brandToneError', 'Please select a brand tone');
                isValid = false;
            }
            
            return isValid;
        }

        function showError(errorId, message) {
            let field = null;
            let errorDiv = null;
            
            if (errorId === 'urlError') {
                field = document.getElementById('productUrl');
                errorDiv = document.getElementById('urlError');
            } else if (errorId === 'barcodeError') {
                field = document.getElementById('productBarcode');
                errorDiv = document.getElementById('barcodeError');
            } else if (errorId === 'brandToneError') {
                field = document.getElementById('brandTone');
                errorDiv = document.getElementById('brandToneError');
            }
            
            if (field) {
                field.classList.add('error');
            }
            
            if (errorDiv) {
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
            } else {
                // Fallback for missing error divs
                console.error(`Error div not found for ${errorId}: ${message}`);
                showNotification(message, 'error');
            }
        }

        function clearErrors() {
            const errorElements = document.querySelectorAll('.error');
            errorElements.forEach(element => {
                if (element.tagName === 'DIV') {
                    element.textContent = '';
                    element.style.display = 'none';
                } else {
                    element.classList.remove('error');
                }
            });
            
            // Clear specific error divs
            const errorIds = ['urlError', 'barcodeError', 'brandToneError'];
            errorIds.forEach(errorId => {
                const errorDiv = document.getElementById(errorId);
                if (errorDiv) {
                    errorDiv.textContent = '';
                    errorDiv.style.display = 'none';
                }
            });
        }

        async function updateUsageCount() {
            // Increment usage on backend
            try {
                if (!userState.userId || !userState.isAuthenticated) {
                    return; // User not authenticated
                }
                
                // Use centralized token manager for authentication
                const response = await makeAuthenticatedRequest('/.netlify/functions/firebase-user', {
                    method: 'POST',
                    body: JSON.stringify({
                        action: 'increment_usage',
                        userId: userState.userId
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.user) {
                        console.log('Usage updated on server');
                    }
                }
            } catch (error) {
                console.log('Usage update skipped:', error.message);
            }
        }

        async function syncUserData() {
            // Sync with backend user data
            try {
                if (!userState.userId || !userState.isAuthenticated) {
                    return; // User not authenticated
                }
                
                // Use centralized token manager for authentication
                const response = await makeAuthenticatedRequest('/.netlify/functions/firebase-user', {
                    method: 'POST',
                    body: JSON.stringify({
                        action: 'get_user',
                        userId: userState.userId
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.user) {
                        console.log('User data synced from server');
                    }
                }
            } catch (error) {
                console.log('Sync skipped:', error.message);
                // Don't show error to user - sync is optional
            }
        }

        async function refreshUsage() {
            // Manual sync for users to refresh their usage data
            await syncUserData();
            showNotification('Usage data refreshed', 'success');
        }

        function updateUsageDisplay() {
            // Usage display is now managed server-side
            // This function is kept for compatibility but does nothing
        }

        function addEntranceAnimations() {
            // Add subtle entrance animations
            const sections = document.querySelectorAll('.generator-section, .pricing-section');
            sections.forEach((section, index) => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(30px)';
                
                setTimeout(() => {
                    section.style.transition = 'all 0.8s ease';
                    section.style.opacity = '1';
                    section.style.transform = 'translateY(0)';
                }, index * 200);
            });
        }

        function showNotification(message, type = 'success') {
            // Remove existing notification if any
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }

            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            // Show notification
            setTimeout(() => notification.classList.add('show'), 100);

            // Hide notification after 4 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            }, 4000);
        }

        // Check for successful payment on page load
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('success') === 'true') {
            showNotification('Payment processed successfully!', 'success');
            
            // Clean up URL
            window.history.replaceState({}, document.title, window.location.pathname);
        }
        
        function showPayPalButton(planType) {
            document.querySelectorAll('.paypal-button-container').forEach(container => {
                container.classList.remove('show');
            });
            document.getElementById('paypal-' + planType).classList.add('show');
        }
    </script>
    
    <!-- Support Footer -->
    <footer style="background: #1e293b; padding: 20px 0; text-align: center; margin-top: 40px; border-top: 1px solid #334155;">
        <div class="container" style="max-width: 1200px; margin: 0 auto; padding: 0 20px;">
            <p style="color: #94a3b8; margin-bottom: 10px; font-size: 14px;">Need help or have questions?</p>
            <p style="margin: 0;">
                <a href="mailto:support@soltecsol.com" 
                   style="color: #60a5fa; text-decoration: none; font-weight: 600; font-size: 16px;">
                   support@soltecsol.com
                </a>
            </p>
        </div>
    </footer>
</body>
</html>
